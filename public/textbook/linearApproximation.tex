\chapter{Linear Approximation}

\section{Linear Approximation and Differentials}



Given a function, a \textit{linear approximation} is a fancy phrase
for something you already know.

\begin{definition}\index{linear approximation}
If $f(x)$ is a differentiable function at $x=a$, then a \textbf{linear
  approximation} for $f(x)$ at $x=a$ is given by
\[
\l(x) = f'(a)(x-a) +f(a).
\]
\end{definition}

A linear approximation of $f(x)$ is a good approximation of $f(x)$ as
long as $x$ is ``not too far'' from $a$.  As we see from
Figure~\ref{figure:informal-tangent}, if one can ``zoom in'' on $f(x)$
sufficiently, then $f(x)$ and the linear approximation are nearly
indistinguishable. Linear approximations allow us to make approximate
``difficult'' computations.

\begin{example}
Use a linear approximation of $f(x) =\sqrt[3]{x}$ at $x=64$ to
approximate $\sqrt[3]{50}$.
\end{example}



\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=1,xmax=100,ymin=0,ymax=5,
            axis lines=center,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=150,smooth,domain=(0:100)] {x^(1/3))};
          \addplot [very thick, penColor2, domain=(0:100)] {x/48+8/3};
          \addplot [textColor,dashed] plot coordinates {(64,0) (64,4)};
          \addplot [textColor,dashed] plot coordinates {(0,4) (64,4)};
          \node at (axis cs:20,2.3) [penColor] {$f(x)$};
          \node at (axis cs:20,3.3) [penColor2] {$\l(x)$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(64,4)};  %% closed hole            
        \end{axis}
\end{tikzpicture}
\caption{A linear approximation of $f(x) = \sqrt[3]{x}$ at $x=4$.}
\label{figure:la sqrt3x}
\end{marginfigure}


\begin{solution}
To start, write
\[
\ddx f(x) = \ddx x^{1/3} = \frac{1}{3x^{2/3}}.
\]
so our linear approximation is
\begin{align*}
\l(x) &= \frac{1}{3\cdot 64^{2/3}} (x-64) + 4 \\
&= \frac{1}{48} (x-64) + 4\\
&= \frac{x}{48} +\frac{8}{3}.
\end{align*}
Now we evaluate $\l(50) \approx 3.71$ and compare it to
$\sqrt[3]{50}\approx 3.68$, see Figure~\ref{figure:la sqrt3x}. From
this we see that the linear approximation, while perhaps inexact, is
computationally \textbf{easier} than computing the cube root.
\end{solution}

With modern calculators and computing software it may not appear
necessary to use linear approximations. But in fact they are quite
useful. In cases requiring an explicit numerical approximation, they
allow us to get a quick rough estimate which can be used as a
``reality check'' on a more complex calculation. In some complex
calculations involving functions, the linear approximation makes an
otherwise intractable calculation possible, without serious loss of
accuracy.




\begin{example}%\label{exam:linear approximation of sine}
Use a linear approximation of $f(x) =\sin(x)$ at $x=0$ to approximate
$\sin(0.3)$.
\end{example}

\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=-1.6,xmax=1.6,ymin=-1.5,ymax=1.5,
            axis lines=center,
            xtick={-1.57, 0, 1.57},
            xticklabels={$-\pi/2$, $0$, $\pi/2$},
            ytick={-1,1},
            %ticks=none,
            %width=3in,
            %height=2in,
            unit vector ratio*=1 1 1,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=100,smooth, domain=(-1.6:1.6)] {sin(deg(x))};
          \addplot [very thick, penColor2, samples=100,smooth] {x};
          \node at (axis cs:1,.6) [penColor] {$f(x)$};
          \node at (axis cs:-1,-1.2) [penColor2] {$\l(x)$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(0,0)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{A linear approximation of $f(x) = \sin(x)$ at $x=0$.}
\label{figure:la sin}
\end{marginfigure}

\begin{solution}
To start, write
\[
\ddx f(x) = \cos(x),
\]
so our linear approximation is
\begin{align*}
\l(x) &= 1\cdot(x-0) + 0\\
&= x.
\end{align*}
Hence a linear approximation for $\sin(x)$ at $x=0$ is $\l(x) = x$,
and so $\l(0.3) = 0.3$.  Comparing this to $\sin(.3) \approx 0.295$. As
we see the approximation is quite good. For this reason, it is common
to approximate $\sin(x)$ with its linear approximation $\l(x) = x$
when $x$ is near zero, see Figure~\ref{figure:la sin}.
\end{solution}


\subsection*{Differentials}

The notion of a \textit{differential} goes back to the origins of
calculus, though our modern conceptualization of a differential is
somewhat different than how they were initially understood.

\begin{definition}\index{differential}
Let $f(x)$ be a differentiable function. We define a new
  independent variable $dx$, and a new dependent variable
\[
dy=f'(x)\cdot dx.
\] 
The variables $dx$ and $dy$ are called \textbf{differentials}, see
Figure~{figure:differentials}.
\end{definition}
\begin{marginfigure}[0in]
\begin{tikzpicture}
	\begin{axis}[
            xmin=1, xmax=2, range=0:6,ymax=6,ymin=0,
            axis lines =left, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            ticks=none,
            axis on top,
          ]         
	  \addplot [penColor2,very thick] plot coordinates {(1.4,10/6) (1.7,10/6)};
          \addplot [penColor2,very thick] plot coordinates {(1.7,10/6) (1.7,10/6 +.3/.36)};
          \addplot [penColor,dashed] plot coordinates {(1.4,10/6) (1.7,10/6 +.3/.36)};
          \addplot [very thick,penColor, smooth,samples=100,domain=(0:1.833)] {-1/(x-2)};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(1.4,10/6)};  %% closed hole            
          \node at (axis cs:1.55,1.67) [below, penColor2] {$dx$};
          \node at (axis cs:1.7,2.08) [right, penColor2] {$dy$};
        \end{axis}
\end{tikzpicture}
\caption{While $dy$ and $dx$ are both variables, $dy$ depends on $dx$,
  and approximates how much a function grows after a change of size
  $dx$ from a given point.}
\label{figure:differentials}
\end{marginfigure}

Note, it is now the case (by definition!) that 
\[
\frac{dy}{dx} = f'(x).
\]

Essentially, differentials allow us to solve the problems presented in
the previous examples from a slightly different point of view. Recall,
when $h$ is near but not equal zero,
\[
f'(x) \approx \frac{f(x+h)-f(x)}{h}
\]
hence, 
\[
f'(x)h \approx f(x+h)-f(x)
\]
since $h$ is simply a variable, and $dx$ is simply a variable, we can replace $h$ with $dx$ to write
\begin{align*}
f'(x)\cdot dx &\approx f(x+dx)-f(x)\\
dy &\approx f(x+dx)-f(x).
\end{align*}
From this we see that 
\[
f(x+dx)\approx dy + f(x).
\]
While this is something of a ``slight-of-hand'' with variables, there
are contexts where the language of differentials is common. We will
repeat our previous examples using differentials.

\begin{example}
Use differentials to approximate $\sqrt[3]{50}$.
\end{example}

\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=1,xmax=100,ymin=2,ymax=5,
            axis lines=center,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=150,smooth,domain=(0:100)] {x^(1/3))};
          %\addplot [very thick, penColor2, domain=(50:64)] {x/48+8/3};
          %\addplot [textColor,dashed] plot coordinates {(64,0) (64,4)};
          \node at (axis cs:20,2.3) [penColor] {$f(x)$};
          \addplot [penColor2,very thick] plot coordinates {(64,4) (64,3.71)};
          \addplot [penColor2,very thick] plot coordinates {(50,3.71) (64,3.71)};
          \node [below] at (axis cs:57,3.7) [penColor2] {$dx$};
          \node [right] at (axis cs:64,3.8) [penColor2] {$dy$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(64,4)};  %% closed hole            
        \end{axis}
\end{tikzpicture}
\caption{A plot of $f(x) = \sqrt[3]{x}$  along with the differentials $dx$ and
  $dy$.}
\label{figure:diff sqrt3x}
\end{marginfigure}


\begin{solution}
Since $4^3 = 64$ is a perfect cube near $50$, we will set $dx=-14$. In this case
\[
\frac{dy}{dx} = f'(x)  = \frac{1}{3x^{2/3}}
\]
hence 
\begin{align*}
dy &= \frac{1}{3x^{2/3}} \cdot dx\\
&= \frac{1}{3\cdot64^{2/3}} \cdot(-14)\\
&= \frac{1}{3\cdot64^{2/3}} \cdot(-14)\\
&= \frac{-7}{24}
\end{align*}
Now $f(50) \approx f(64) + \frac{-7}{24} \approx 3.71$.
\end{solution}


\begin{example}
Use differentials to approximate $\sin(0.3)$.
\end{example}

\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=-1.6,xmax=1.6,ymin=-1.5,ymax=1.5,
            axis lines=center,
            xtick={-1.57, 0, 1.57},
            xticklabels={$-\pi/2$, $0$, $\pi/2$},
            ytick={-1,1},
            %ticks=none,
            %width=3in,
            %height=2in,
            unit vector ratio*=1 1 1,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=100,smooth, domain=(-1.6:1.6)] {sin(deg(x))};
          %\addplot [very thick, penColor2, domain={0:0.3}] {x};
          \addplot [penColor2,very thick] plot coordinates {(0,0) (.3,0)};
          \addplot [penColor2,very thick] plot coordinates {(.3,0) (.3,.3)};
          \node at (axis cs:1,.6) [penColor] {$f(x)$};
          \node [below] at (axis cs:.15,.0) [penColor2] {$dx$};
          \node [right] at (axis cs:.3,.15) [penColor2] {$dy$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(0,0)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{A plot of $f(x) = \sin(x)$ along with the differentials $dx$ and
  $dy$.}
\label{figure:diff sin}
\end{marginfigure}


\begin{solution}
Since $\sin(0) = 0$, we will set $dx=0.3$. In this case
\[
\frac{dy}{dx} = f'(x)  = \cos(x)
\]
hence 
\begin{align*}
dy &= \cos(1) \cdot dx\\
&= 1 \cdot (0.3)\\
&= 0.3
\end{align*}
Now $f(.3) \approx f(0) + 0.3 \approx 0.3$.
\end{solution}

The upshot is that linear approximations and differentials are simply
two slightly different ways of doing the exact same thing.





\begin{exercises}

\begin{exercise}
Use a linear approximation of $f(x) =\sin(x/2)$ at $x=0$ to approximate
$f(0.1)$.
\begin{answer}
$\sin(0.1/2)\approx 0.05$
\end{answer}
\end{exercise}

\begin{exercise}
Use a linear approximation of $f(x) =\sqrt[3]{x}$ at $x=8$ to approximate
$f(10)$.
\begin{answer}
$\sqrt[3]{10}\approx 2.17$
\end{answer}
\end{exercise}

\begin{exercise}
Use a linear approximation of $f(x) =\sqrt[5]{x}$ at $x=243$ to approximate
$f(250)$.
\begin{answer}
$\sqrt[5]{250}\approx 3.017$
\end{answer}
\end{exercise}


\begin{exercise}
Use a linear approximation of $f(x) =\ln(x)$ at $x=1$ to approximate
$f(1.5)$.
\begin{answer}
$\ln(1.5)\approx 0.5$
\end{answer}
\end{exercise}

\begin{exercise}
Use a linear approximation of $f(x) =\ln(\sqrt{x})$ at $x=1$ to approximate
$f(1.5)$.
\begin{answer}
$\ln(\sqrt{1.5})\approx 0.25$
\end{answer}
\end{exercise}


\begin{exercise} 
Let $f(x) = \sin(x/2)$. If $x=1$ and $dx=1/2$, what is $dy$?
\begin{answer} $dy=2$
\end{answer}\end{exercise}

\begin{exercise} 
Let $f(x) = \sqrt{x}$. If $x=1$ and $dx =1/10$, what is $dy$?
\begin{answer} $dy=0.05$
\end{answer}\end{exercise}

\begin{exercise} 
Let $f(x) = \ln(x)$. If $x=1$ and $dx =1/10$, what is $dy$?
\begin{answer} $dy=0.1$
\end{answer}\end{exercise}


\begin{exercise} 
Let $f(x) = \sin (2x)$. If $x=\pi$ and $dx=\pi/100$, what is $dy$?
\begin{answer} $dy=\pi/50$
\end{answer}\end{exercise}

\begin{exercise} Use differentials to estimate the amount of paint needed to
 apply a coat of paint 0.02 cm thick to a sphere with diameter $40$
 meters. Hint: Recall that the volume of a sphere of radius $r$ is $V
 =(4/3)\pi r^3$. Notice that you are given that $dr=0.02$.
\begin{answer} $dV=8\pi/25$
\end{answer}\end{exercise}

\end{exercises}












\section{Newton's Method}

Suppose you have a function $f(x)$, and you want to solve $f(x)=0$.
Solving equations symbolically, is difficult. However, Newton's method
gives us a procedure, for finding a solution to many equations to as
many decimal places as you want.  

\marginnote[.5in]{The point
\[
a_{n+1} = a_n - \frac{f(a_n)}{f'(a_n)}
\]
is the solution to the equation $\l_n(x) = 0$, where $\l_n(x)$ is the
linear approximation of $f(x)$ at $x=a_n$.}

\begin{newtonsMethod}
Let $f(x)$ be a differentiable function and let $a_0$ be a
guess for a solution to the equation
\[
f(x) = 0.
\]
We can produce a sequence of points $x=a_0, a_1, a_2, a_3, \dots$ via
the recursive formula
\[
a_{n+1} = a_n -\frac{f(a_n)}{f'(a_n)}
\]
that (hopefully!) are successively better approximations of a solution
to the equation $f(x) = 0$.
\end{newtonsMethod}
Let's see if we can explain the logic behind this method. Consider the
following cubic function
\[
f(x) = x^3 - 4 x^2 - 5 x - 7.
\]
While there is a ``cubic formula'' for finding roots, it can be
difficult to implement. Since it is clear that $f(10)$ is positive,
and $f(0)$ is negative, by the Intermediate Value
Theorem~\ref{theorem:IVT}, there is a solution to the equation $f(x) =
0$ in the interval $[0,10]$. Let's compute $f'(x) = 3x^2 -8x-5$ and
guess that $a_0=7$ is a solution. We can easily see that
\[
f(a_0) = f(7) = 105\qquad\text{and}\qquad f'(a_0) = f'(7) = 86.
\]
This might seem pretty bad, but if we look at the linear approximation
of $f(x)$ at $x=7$, we find
\begin{marginfigure}[-1in]
\begin{tikzpicture}
	\begin{axis}[
            xmin=4, xmax=7.5,ymin=-40,ymax=125,domain=(4:8),
            axis lines =center, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            xtick={7}, ytickmin=1,ytickmax=0,
            xticklabels={$a_0$},
            axis on top,
          ]         
	  \addplot [penColor2,very thick] {86*(x-7) + 105};
          \addplot [textColor,dashed] plot coordinates {(7,0) (7,105)};
          \addplot [very thick,penColor, smooth,samples=100] {x^3 - 4*x^2 - 5*x - 7};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(7,105)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{Here we see our first guess, along with the linear
  approximation at that point.}
\label{figure:newtonCubic1}
\end{marginfigure}
\[
\l_0(x) = 86(x-7) + 105 \qquad\text{which is the same as}\qquad \l_0(x) = f'(a_0)(x-a_0) + f(a_0).
\]
Now $\l_0(a_1) = 0$ when
\[
a_1 = 7 - \frac{105}{86} \qquad\text{which is the same as}\qquad a_1 = a_0
-\frac{f(a_0)}{f'(a_0)}.
\]
To remind you what is going on geometrically see
Figure~\ref{figure:newtonCubic1}. Now we repeat the procedure letting
$a_1$ be our new guess. Now
\[
f(a_1) \approx 23.5.
\]
We see our new guess is better than our first. If we look at the
linear approximation of $f(x)$ at $x=a_1$, we find
\[
\l_1(x) = f'(a_0)(x-a_0) + f(a_0).
\]
Now $\l_1(a_2) = 0$ when
\[
a_2 = a_1 - \frac{f(a_1)}{f'(a_1)}.
\]

\begin{marginfigure}[-2in]
\begin{tikzpicture}
	\begin{axis}[
            xmin=4, xmax=7.5,ymin=-40,ymax=125,domain=(4:8),
            axis lines =center, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            xtick={5.78,7}, ytickmin=1,ytickmax=0,
            xticklabels={$a_1$,$a_0$},
            axis on top,
          ]         
	  \addplot [penColor2!40!background,very thick] {86*(x-7) + 105};
          \addplot [textColor!40!background,dashed] plot coordinates {(7,0) (7,105)};
          \addplot [penColor2,very thick] {49*x-259.4};
          \addplot [textColor,dashed] plot coordinates {(5.78,0) (5.78,23.57)};
          \addplot [very thick,penColor, smooth,samples=100] {x^3 - 4*x^2 - 5*x - 7};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(5.78,23.57)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{Here we see our second guess, along with the linear
  approximation at that point.}
\label{figure:newtonCubic2}
\end{marginfigure}
See Figure~{figure:newtonCubic2} to see what is going on
geometrically.  Again, we repeat our procedure letting $a_2$ be our
next guess, note
\[
f(a_2) \approx 2.97,
\]
we are getting much closer to a root of $f(x)$. Looking at the linear
approximation of $f(x)$ at $x=a_2$, we find
\[
\l_2(x) = f'(a_2)(x-a_2) + f(a_2).
\]
Setting $a_3 = a_2 - \frac{f(a_2)}{f'(a_2)}$, $a_3\approx 5.22$. We now
have $\l_2(a_3) = 0$. Checking by evaluating $f(x)$ at $a_3$, we find
\[
f(a_3) \approx 0.14.
\]

\begin{marginfigure}[0in]
\begin{tikzpicture}
	\begin{axis}[
            xmin=4, xmax=7.5,ymin=-40,ymax=125,domain=(4:8),
            axis lines =center, xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            xtick={5.22,5.78,7}, ytickmin=1,ytickmax=0,
            xticklabels={$a_2$,$a_1$,$a_0$},
            axis on top,
          ]         
	  \addplot [penColor2!40!background,very thick] {86*(x-7) + 105};
          \addplot [textColor!40!background,dashed] plot coordinates {(7,0) (7,105)};

          \addplot [penColor2!40!,very thick] {49*x-259.4};
          \addplot [textColor!40!,dashed] plot coordinates {(5.78,0) (5.78,23.57)};

          \addplot [penColor2,very thick] {36.8*x-192.2};
          \addplot [textColor,dashed] plot coordinates {(5.22,0) (5.22,.14)};

          \addplot [very thick,penColor, smooth,samples=100] {x^3 - 4*x^2 - 5*x - 7};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(5.22,.14)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{Here we see our third guess, along with the linear
  approximation at that point.}
\label{figure:newtonCubic3}
\end{marginfigure}
We are now very close to a root of $f(x)$, see
Figure~\ref{figure:newtonCubic3}. This process, Newton's Method, could
be repeated indefinitely to obtain closer and closer approximations to
a root of $f(x)$.


\begin{example}
Use Newton's Method to approximate the solution to 
\[
x^3= 50
\]
to two decimal places. 
\end{example}

\begin{solution} 
To start, set $f(x) = x^3 - 50$. We will use Newton's Method to
approximate a solution to the equation
\[
f(x) = x^3-50 = 0. 
\]
Let's choose $a_0=4$ as our first guess. Now compute 
\[
f'(x) = 3x^2.
\]
At this point we can make a table:
\[
\begin{tchart}{llll}
n &  a_n  & f(a_n)         & a_n - f(a_n)/f'(a_n)\\ \hline
0 & 4    & 14             & \approx 3.708 \\
1 & 3.708 & \approx 0.982  & \approx 3.684 \\
2 & 3.684 & \approx -0.001 & \approx 3.684
\end{tchart}
\]
Hence after only two iterations, we have the solution to three (and
hence two) decimal places.
\end{solution}

In practice, which is to say, if you need to approximate a value in
the course of designing a bridge or a building or an airframe, you
will need to have some confidence that the approximation you settle on
is accurate enough. As a rule of thumb, once a certain number of
decimal places stop changing from one approximation to the next it is
likely that those decimal places are correct. Still, this may not be
enough assurance, in which case we can test the result for accuracy.


Sometimes questions involving Newton's Method do not mention an
equation that needs to be solved. Here you must reinterpret the
question as one that is asking for a solution to an equation of the
form $f(x) = 0$.

\begin{example}
Use Newton's Method to approximate $\sqrt[3]{50}$ to two decimal
places.
\end{example}

\begin{solution}
The $\sqrt[3]{50}$ is simply a solution to the equation
\[
x^3 -50 = 0.
\]
Since we did this in the previous example, we have found
$\sqrt[3]{50}\approx 3.68$.
\end{solution}

\begin{warning}
Sometimes a bad choice for $a_0$ will not lead to a root. Consider 
\[
f(x) = x^3 - 3 x^2 - x - 4.
\]
If we choose our initial guess to be $a_0=1$ and make a table we find:
\[
\begin{tchart}{llll}
n &  a_n  & f(a_n)         & a_n - f(a_n)/f'(a_n)\\ \hline
0 & 1    & -7             & -0.75 \\
1 & -0.75 & \approx -5.359  & \approx 0.283 \\
2 & 0.283 & \approx -4.501 & \approx -1.548 \\
3 & -1.548 & \approx -13.350 & \approx -0.685 \\
4 & -0.685 & \approx -5.044 & \approx 0.432 \\
  \hdotsfor{4}
\end{tchart}
\]
As you can see, we are not converging to a root, which is
approximately $x=3.589$.
\end{warning}



Iterative procedures like Newton's method are well suited for
computers. It enables us to solve equations that are otherwise
impossible to solve through symbolic methods.






\subsection*{Euler's Method}


\marginnote[.2in]{The name ``Euler'' is pronounced ``Oiler.''}
While Newton's Method allows us to solve equations that are otherwise
impossible to solve, and hence is of computational importance,
Euler's Method is more of theoretical importance to us.

\break

\begin{eulersMethod}
Given a function $f(x)$, and an initial value $(x_0,y_0)$ we wish to
find a polygonal curve defined by $(x_n,y_n)$ such that this polygonal
curve approximates $F(x)$ where $F'(x) =f(x)$, and $F(x_0)= y_0$.
\begin{enumerate}
\item Choose a step size, call it $h$.
\item Our polygonal curve defined by connecting the points as
  described by the iterative process below:
\[
\begin{tchart}{lll}
n & x_n     & y_n \\ \hline
0 & x_0     & y_0 \\
1 & x_0 + h & y_0+h\cdot f(x_1)\\
2 & x_1 + h & y_1+h\cdot f(x_2)\\
3 & x_2 + h & y_2+h\cdot f(x_3)\\
4 & x_3 + h & y_3+h\cdot f(x_4)\\
  \hdotsfor{3}
\end{tchart}
\]
\end{enumerate}
\end{eulersMethod}


Let's see an example of Euler's Method in action.

\begin{example}
Suppose that the velocity in meters per second of a ball tossed from a
height of 1 meter is given by
\[
v(t) = -9.8t + 6.
\]
Rounding to two decimals at each step, use Euler's Method with $h=0.2$
to approximate the height of the ball after 1 second.
\end{example}
\begin{marginfigure}[0in]
\begin{tikzpicture}
	\begin{axis}[
            xmin=0, xmax=1,ymin=0,ymax=3,
            axis lines =center, xlabel=$t$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
            xtick={0,.2,.4,.6,.8,1},
            axis on top,
          ]         
	  \addplot [penColor2, very thick] plot coordinates {
            (0,1) (.2,1.81) (.4,2.23) (.6,2.25) (.8,1.88) (1,1.12)
          };
          \addplot [very thick,penColor, smooth,samples=100] {6*x-4.9*x^2+1};
          \node at (axis cs:.3,2.6) [penColor] {$f(x)$};          
        \end{axis}
\end{tikzpicture}
\caption{Here we see our polygonal curve found via Euler's Method and
  the (unknown) function $F(x)$. Choosing a smaller step-size $h$
  would yield a better approximation.}
\label{figure:eulerMethod-ball}
\end{marginfigure}

\begin{solution}
We simply need to make a table and use Euler's Method.
\[
\begin{tchart}{lll}
n & t_n & y_n \\ \hline
0 & 0   & 1 \\
1 & 0.2 & 1.81\\
2 & 0.4 & 2.23\\
3 & 0.6 & 2.25\\
4 & 0.8 & 1.88\\
5 & 1 & 1.12
\end{tchart}
\]
Hence the ball is at a height of $1.12$ meters, see
Figure~\ref{figure:eulerMethod-ball}.
\end{solution}



\begin{exercises}

\begin{exercise} Approximate the fifth root of 7, using $x_0=1.5$ as a
first guess. Use Newton's method to find $x_3$ as your
approximation.  
\begin{answer} $x_3=1.475773162$ 
\end{answer}\end{exercise}

\begin{exercise} Use Newton's Method to approximate the cube root of 10 to
two decimal places.
\begin{answer} $2.15$
\end{answer}\end{exercise}

\begin{exercise} The function 
$f(x)=x^3-3x^2-3x+6$ has a root between 3 and 4, because
$f(3)=-3$ and $f(4)=10$. Approximate the root to two decimal places.
\begin{answer}  $3.36$
\end{answer}\end{exercise}

\begin{exercise} A rectangular piece of cardboard of dimensions $8\times 17$
is used to make an open-top box by cutting out a small square of side
$x$ from each corner and bending up the sides.  (See
exercise~\xrefn{sec:optimization}.\xrefn{exercise: cardboard box}.)
If $x=2$, then the volume of the box is $2\cdot 4\cdot 13=104$.  Use
Newton's method to find a value of $x$ for which the box has volume
100, accurate to 3 significant figures.  
\begin{answer} $2.19$ or $1.26$
\end{answer}\end{exercise}

% Mike Wills stuff
% \iflatetranscendentals
% 
% \begin{remark} {Further investigation} Newton's method does not always
% work. The following result gives sufficient conditions for when it
% does.  \end{remark}
% 
% \begin{theorem} (Newton) Let $f:[a,b] \rightarrow \R$ be continuous. Suppose that
% $f(c) =0$ for some $c$ in $(a,b)$.  Suppose that $f''$ exists and is
% bounded on $(a,b)$; that is, there exists $M>0$ such that
% $$f''(x) \leq M $$ 
% for every $x\in (a,b)$.
% 
% Suppose that $f'$ is bounded away from zero; that is, there exists
% $\epsilon >0$ such that
% $$f'(x) \geq \epsilon $$ for every $x \in (a,b)$. Then there is a
% closed interval $I:=[d,e] \subset (a,b)$ containing $c$ such that
% the sequence given recursively by
% $$x_n = x_{n-1} -f(x_{n-1})/f'(x_{n -1}) $$ converges to
% $c$. Moreover, $x_n$ is in $I$ for each $n$.
% \end{proof}
% 
% \noindent
% For this to make sense it helps if we have a notion of convergence of
% sequences. We will do this in second semester calculus. For now, we
% will just use the intuitive statement ``as $n$ gets large, $x_n$ gets
% arbitrarily close to $c$" and write 
% $\displaystyle{\lim _{n\rightarrow\infty } x_n }= c$.
% 
% \noindent
% Let us now analyze the various conditions in the statement.
% 
% \noindent
% Bounding $f'$ away from zero should seem reasonable from the
% definition of $x_n$ but it is not necessary. The following
% exercise shows that Newton's method may work even if $f'$ is not
% bounded away from zero.
% 
% \begin{exercise} Let $f(x) = x^2$. Adopt the notation of Newton's
% theorem. Show that if $x_{n-1 } \neq 0$ then $x_n
% =x_{n-1}/2$. Suppose that $x_0 = 1.$ What is $x_1$? How about
% $x_2$? How about $x_n$? Argue that $x_n$ converges to zero
% as $n$ goes to $\infty$ when $x_0 =1$.
% 
% \noindent
% In the above example, any $x_0$ except zero will do.  The next
% exercise illustrates what can go wrong if we do not bound $f'$ away
% from zero.
% 
% \begin{exercise} Let $f(x) = x^4 - 4x - 11$. Then $f(0)<0 < f(3)$ so by
% the intermediate value theorem there exists a root between $x=0$ and
% $x=3$. What happens if we apply Newton's method when we start at $\ds
% x_0 =1$?  Sketch the graph of $f$ on the interval $[0,3]$.
%  
% \noindent
% We also require a bound on the second derivative. The following
% exercise shows what can go wrong.
% 
% \begin{exercise} Let $f(x) = x^{1/3}$. Observe that $x=0$ is a root of
% $f$.  Compute $f''(x)$ and explain why $f''$ is unbounded near
% $x=0$. Attempt to use Newton's method with $x_0 = 1$.  What
% happens? Illustrate your conclusion with a diagram.
%  
% \noindent
% Newton's method, when it works, is extremely fast. The number of
% decimal places of accuracy approximately doubles with each successive
% iteration.
%  
% \noindent
% The statement of Newton's theorem does not tell us how to how to find
% the closed interval $I$. The proof gives some indication but is beyond
% the scope of the course.
%  
% \noindent
% For our purposes, we can use a graphing calculator to give us an idea
% of where to look for the roots of a given function and then apply
% Newton's method to get a good decimal approximation.
%  
% \begin{exercise} Use Newton's method to find the coordinates of the
% inflection point of $y=x^3/12 + \sin x$ correct to six decimal
% places.
%  
% \begin{exercise} Let $a$ be a non-zero number. Suppose we want to compute a
% decimal expansion of $1/a$.  This could be difficult if $a$ is big or
% has a large number of decimal places. Newton's method gives us a way
% of computing $a$ without division.  Let $f(x) = 1/x - a$. Notice that
% $f$ has a root at $x=1/a$.  Using the notation of Newton's theorem,
% show that $x_{n} =2x_{n-1} - ax_{n-1}^2$.
%  
% \fi

\end{exercises}











\section{The Mean Value Theorem}

Here are two interesting questions involving derivatives:

\begin{itemize} % BADBAD

\item{1.} Suppose two different functions have the same derivative;
  what can you say about the relationship between the two functions?

\item{2.} Suppose you drive a car from toll booth on a toll road to
  another toll booth at an
  average speed of 70 miles per hour. What can be concluded about your
  actual speed during the trip? In particular, did you exceed the 65
  mile per hour speed limit?

\end{itemize}

While these sound very different, it turns out that the two problems
are very closely related. We know that ``speed'' is really the
derivative by a different name; let's start by translating the second
question into something that may be easier to visualize. Suppose that
the function $f(t)$ gives the position of your car on the toll road at
time $t$. Your change in position between one toll booth and the next
is given by $f(t_1)-f(t_0)$, assuming that at time $t_0$ you were at
the first booth and at time $t_1$ you arrived at the second
booth. Your average speed for the trip is
$(f(t_1)-f(t_0))/(t_1-t_0)$. If we think about the graph of $f(t)$,
the average speed is the slope of the line that connects the two
points $(t_0,f(t_0))$ and $(t_1,f(t_1))$. Your speed at any particular time
$t$ between $t_0$ and $t_1$ is $f'(t)$, the slope of the curve. Now
question (2) becomes a question about slope. In particular, if the
slope between endpoints is 70, what can be said of the slopes at
points between the endpoints?

As a general rule, when faced with a new problem it is often a good idea to
examine one or more simplified versions of the problem, in the hope
that this will lead to an understanding of the original problem.
In this case, the problem in its ``slope'' form is somewhat easier to
simplify than the original, but equivalent, problem.

Here is a special instance of the problem. Suppose that
$f(t_0)=f(t_1)$. Then the two endpoints have the same height and the
slope of the line connecting the endpoints is zero. What can we say
about the slope between the endpoints? It shouldn't take much
experimentation before you are convinced of the truth of this
statement: Somewhere between $t_0$ and $t_1$ the slope is exactly
zero, that is, somewhere between $t_0$ and $t_1$ the slope is equal to
the slope of the line between the endpoints. This suggests that
perhaps the same is true even if the endpoints are at different
heights, and again a bit of experimentation will probably convince you
that this is so. But we can do better than ``experimentation''---we
can prove that this is so.

We start with the simplified version:

\begin{theorem} (Rolle's Theorem) Suppose that $f(x)$ has a derivative on the
interval $(a,b)$, is continuous on the interval $[a,b]$, and
$f(a)=f(b)$. Then at some value $c\in (a,b)$, $f'(c)=0$.
\index{Rolle's Theorem}
\label{thm:rolle}
\end{theorem}

\begin{proof}
We know that $f(x)$ has a maximum and minimum value on $[a,b]$
(because it is continuous), and we
also know that the maximum and minimum must occur at an endpoint, at a
point at which the derivative is zero, or at a point where the
derivative is undefined. Since the derivative is never undefined, that
possibility is removed.

If the maximum or minimum occurs at a point $c$, other than an endpoint,
where $f'(c)=0$, then we have found the point we seek. Otherwise, the
maximum and minimum both occur at an endpoint, and since the endpoints
have the same height, the maximum and minimum are the same. This means
that $f(x)=f(a)=f(b)$ at every $x \in [a,b]$, so the function is a
horizontal line, and it has derivative zero everywhere in
$(a,b)$. Then we may choose any $c$ at all to get $f'(c)=0$.
\end{proof}

Perhaps remarkably, this special case is all we need to prove the more
general one as well.

\begin{theorem} (Mean Value Theorem) 
\label{thm:mvt}
Suppose that $f(x)$ has a derivative on the
interval $(a,b)$ and is continuous on the interval $[a,b]$. 
Then at some value
$c\in (a,b)$, $f'(c)={f(b)-f(a)\over b-a}$.
\index{Mean Value Theorem}
\end{theorem}

\begin{proof}
Let $m={f(b)-f(a)\over b-a}$, and consider a new function
$g(x)=f(x) - m(x-a)-f(a)$. We know that $g(x)$ has a derivative
everywhere, since $g'(x)=f'(x)-m$. We can compute 
$g(a)=f(a)- m(a-a)-f(a) =0$ and
\begin{align*}
g(b)=f(b)-m(b-a)-f(a)&=f(b)-{f(b)-f(a)\over b-a}(b-a)-f(a) \\
&=f(b)-(f(b)-f(a))-f(a)=0. 
\end{align*}
So the height of $g(x)$ is the same at both endpoints. This means, by
Rolle's Theorem, that at some $c$, $g'(c)=0$. But we know that
$g'(c)=f'(c)-m$, so
$$0=f'(c)-m=f'(c)-{f(b)-f(a)\over b-a},$$
which turns into
$$f'(c)={f(b)-f(a)\over b-a},$$
exactly what we want.
\end{proof}

Returning to the original formulation of question (2), we see that if
$f(t)$ gives the position of your car at time $t$, then the Mean Value
Theorem says that at some time $c$, $f'(c)=70$, that is, at some time
you must have been traveling at exactly your average speed for the
trip, and that indeed you exceeded the speed limit.

Now let's return to question (1). Suppose, for example, that two
functions are known to have derivative equal to 5 everywhere,
$f'(x)=g'(x)=5$. It is easy to find such functions: $5x$, $5x+47$,
$5x-132$, etc. Are there other, more complicated, examples? No---the
only functions that work are the ``obvious'' ones, namely, $5x$ plus
some constant. How can we see that this is true?

Although ``5'' is a very simple derivative, let's look at an even
simpler one. Suppose that $f'(x)=g'(x)=0$. Again we can find examples:
$f(x)=0$, $f(x)=47$, $f(x)=-511$ all have $f'(x)=0$. Are there
non-constant functions $f$ with derivative 0? No, and here's why:
Suppose that $f(x)$ is not a constant function. This means that there
are two points on the function with different heights, say
$f(a)\not=f(b)$. The Mean Value Theorem tells us that at some point
$c$, $f'(c)=(f(b)-f(a))/(b-a)\not=0$. So any non-constant function
does not have a derivative that is zero everywhere; this is the same
as saying that the only functions with zero derivative are the
constant functions.

Let's go back to the slightly less easy example: suppose that 
$f'(x)=g'(x)=5$. Then $(f(x)-g(x))' = f'(x)-g'(x) = 5 -5 =0$. So using
what we discovered in the previous paragraph, we know that
$f(x)-g(x)=k$, for some constant $k$. So any two functions with
derivative 5 must differ by a constant; since $5x$ is known to work,
the only other examples must look like $5x+k$.

Now we can extend this to more complicated functions, without any
extra work. Suppose that $f'(x)=g'(x)$. Then as before
$(f(x)-g(x))' = f'(x)-g'(x) =0$, so $f(x)-g(x)=k$. Again this means
that if we find just a single function $g(x)$ with a certain
derivative, then every other function with the same derivative must be
of the form $g(x)+k$.

\begin{example}
Describe all functions that have derivative $5x-3$. It's easy to find
one: $g(x)=(5/2)x^2-3x$ has $g'(x)=5x-3$. The only other functions
with the same derivative are therefore of the form
$f(x)=(5/2)x^2-3x+k$.

Alternately, though not obviously, you might have first noticed that 
$g(x)=(5/2)x^2-3x+47$ has $g'(x)=5x-3$. Then every other function
with the same derivative must have the form $f(x)=(5/2)x^2-3x+47+k$.
This looks different, but it really isn't. The functions of the form
$f(x)=(5/2)x^2-3x+k$ are exactly the same as the ones of the form
$f(x)=(5/2)x^2-3x+47+k$. For example, $(5/2)x^2-3x+10$ is the same as
$(5/2)x^2-3x+47+(-37)$, and the first is of the first form while
the second has the second form.
\end{example}

This is worth calling a theorem:

\begin{theorem} If $f'(x)=g'(x)$ for every $x\in (a,b)$, then for some constant
$k$, $f(x)=g(x)+k$ on the interval $(a,b)$.
\end{theorem}

\begin{example}
Describe all functions with derivative $\sin x$. One such
function is $-\cos x$, so all such functions have the form
$-\cos x+k$.
\end{example}



\begin{example}
Describe all functions with derivative $\sin x + e^x$. One such
function is $-\cos x+e^x$, so all such functions have the form
$-\cos x+e^x+k$.
\end{example}

\begin{exercises}

\begin{exercise} Let $f(x) = x^2$.
Find a value $c\in (-1,2)$ so that $f'(c)$ equals the slope between
the endpoints of $f(x)$ on $[-1,2]$.
\begin{answer} $c=1/2$
\end{answer}\end{exercise}

\begin{exercise} Verify that $f(x) = x/(x+2)$ satisfies the hypotheses of the
 Mean Value Theorem on the interval $[1,4]$ and then find all of the
 values, $c$, that satisfy the conclusion of the theorem.
\begin{answer} $c=\sqrt{18}-2$
\end{answer}\end{exercise}

\begin{exercise}
Verify that $f(x) = 3x/(x+7)$ satisfies the hypotheses of the
 Mean Value Theorem on the interval $[-2 , 6]$ and then find all of the
 values, $c$, that satisfy the conclusion of the theorem.
\end{exercise}

\begin{exercise} Let $f(x) = \tan x $. Show that $f(\pi ) = f(2\pi)=0$ but
there is no number $c\in (\pi,2\pi)$ such that $f'(c) =0$. Why does
this not contradict Rolle's theorem?
\end{exercise}

\begin{exercise} Let $f(x) = (x-3)^{-2}$.  Show that there is no value 
$c\in (1,4)$ such that $f'(c) = (f(4)-f(1))/(4-1)$.  Why is
this not a contradiction of the Mean Value Theorem?
\end{exercise}

\begin{exercise} Describe all functions with derivative $x^2+47x-5$.
\begin{answer} $x^3/3+47x^2/2-5x+k$
\end{answer}\end{exercise}

\begin{exercise} Describe all functions with derivative ${1\over 1+x^2}$.
\begin{answer} $\arctan x + k$
\end{answer}\end{exercise}

\begin{exercise} Describe all functions with derivative $x^3-{1\over x}$.
\begin{answer} $x^4/4 -\ln x +k$
\end{answer}\end{exercise}


\begin{exercise} Describe all functions with derivative $\sin(2x)$.
\begin{answer} $-\cos(2x)/2 +k$
\end{answer}\end{exercise}

\begin{exercise} Show that the equation $6x^4 -7x+1 =0$ does not have more
than two distinct real roots.
\end{exercise}

\begin{exercise} Let $f$ be differentiable on $\R$. Suppose that $f'(x) \neq
0$ for every $x$. Prove that $f$ has at most one real root.
\end{exercise}
 
\begin{exercise} Prove that for all real $x$ and $y$
$|\cos x -\cos y | \leq |x-y|$.
State and prove an analogous result involving sine.
\end{exercise}

\begin{exercise}
Show that
$\sqrt{1+x} \le 1 +(x/2)$ if $-1<x<1$.
\end{exercise}

\end{exercises}

