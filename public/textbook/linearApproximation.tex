\chapter{Linear Approximation}

\section{Linear Approximation and Differentials}



Given a function, a \textit{linear approximation} is a fancy phrase
for something you already know.

\begin{definition}\index{linear approximation}
If $f(x)$ is a differentiable function at $x=a$, then a \textbf{linear
  approximation} for $f(x)$ at $x=a$ is given by
\[
\l(x) = f'(a)(x-a) +f(a).
\]
\end{definition}

A linear approximation of $f(x)$ is a good approximation of $f(x)$ as
long as $x$ is ``not too far'' from $a$.  As we see from
Figure~\ref{figure:informal-tangent}, if one can ``zoom in'' on $f(x)$
sufficiently, then $f(x)$ and the linear approximation are nearly
indistinguishable. Linear approximations allow us to make approximate
``difficult'' computations.

\begin{example}
Use a linear approximation of $f(x) =\sqrt[3]{x}$ at $x=64$ to
approximate $\sqrt[3]{50}$.
\end{example}



\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=1,xmax=100,ymin=0,ymax=5,
            axis lines=center,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=150,smooth,domain=(0:100)] {x^(1/3))};
          \addplot [very thick, penColor2, domain=(0:100)] {x/48+8/3};
          \addplot [textColor,dashed] plot coordinates {(64,0) (64,4)};
          \addplot [textColor,dashed] plot coordinates {(0,4) (64,4)};
          \node at (axis cs:20,2.3) [penColor] {$f(x)$};
          \node at (axis cs:20,3.3) [penColor2] {$\l(x)$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(64,4)};  %% closed hole            
        \end{axis}
\end{tikzpicture}
\caption{A linear approximation of $f(x) = \sqrt[3]{x}$ at $x=4$.}
\label{figure:la sqrt3x}
\end{marginfigure}


\begin{solution}
To start, write
\[
\ddx f(x) = \ddx x^{1/3} = \frac{1}{3x^{2/3}}.
\]
so our linear approximation is
\begin{align*}
\l(x) &= \frac{1}{3\cdot 64^{2/3}} (x-64) + 4 \\
&= \frac{1}{48} (x-64) + 4\\
&= \frac{x}{48} +\frac{8}{3}.
\end{align*}
Now we evaluate $\l(50) \approx 3.71$ and compare it to
$\sqrt[3]{50}\approx 3.68$, see Figure~\ref{figure:la sqrt3x}. From
this we see that the linear approximation, while perhaps inexact, is
computationally \textbf{easier} than computing the cube root.
\end{solution}

With modern calculators and computing software it may not appear
necessary to use linear approximations. But in fact they are quite
useful. In cases requiring an explicit numerical approximation, they
allow us to get a quick rough estimate which can be used as a
``reality check'' on a more complex calculation. In some complex
calculations involving functions, the linear approximation makes an
otherwise intractable calculation possible, without serious loss of
accuracy.




\begin{example}%\label{exam:linear approximation of sine}
Use a linear approximation of $f(x) =\sin(x)$ at $x=0$ to approximate
$\sin(0.3)$.
\end{example}

\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=-1.6,xmax=1.6,ymin=-1.5,ymax=1.5,
            axis lines=center,
            xtick={-1.57, 0, 1.57},
            xticklabels={$-\pi/2$, $0$, $\pi/2$},
            ytick={-1,1},
            %ticks=none,
            %width=3in,
            %height=2in,
            unit vector ratio*=1 1 1,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=100,smooth, domain=(-1.6:1.6)] {sin(deg(x))};
          \addplot [very thick, penColor2, samples=100,smooth] {x};
          \node at (axis cs:1,.6) [penColor] {$f(x)$};
          \node at (axis cs:-1,-1.2) [penColor2] {$\l(x)$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(0,0)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{A linear approximation of $f(x) = \sin(x)$ at $x=0$.}
\label{figure:la sin}
\end{marginfigure}

\begin{solution}
To start, write
\[
\ddx f(x) = \cos(x),
\]
so our linear approximation is
\begin{align*}
\l(x) &= 1\cdot(x-0) + 0\\
&= x.
\end{align*}
Hence a linear approximation for $\sin(x)$ at $x=0$ is $\l(x) = x$,
and so $\l(0.3) = 0.3$.  Comparing this to $\sin(.3) \approx 0.295$. As
we see the approximation is quite good. For this reason, it is common
to approximate $\sin(x)$ with its linear approximation $\l(x) = x$
when $x$ is near zero, see Figure~\ref{figure:la sin}.
\end{solution}


\subsection*{Differentials}

The notion of a \textit{differential} goes back to the origins of
calculus, though our modern conceptualization of a differential is
somewhat different than how they were initially understood.

\begin{definition}\index{differential}
Let $f(x)$ be a differentiable function. We define a new
  independent variable $dx$, and a new dependent variable
\[
dy=f'(x)\cdot dx.
\] 
The variables $dx$ and $dy$ are called \textbf{differentials}.
\end{definition}

Note, it is now the case (by definition!) that 
\[
\frac{dy}{dx} = f'(x).
\]

Essentially, differentials allow us to solve the problems presented in
the previous examples from a slightly different point of view. Recall,
when $h$ is near but not equal zero,
\[
f'(x) \approx \frac{f(x+h)-f(x)}{h}
\]
hence, 
\[
f'(x)h \approx f(x+h)-f(x)
\]
since $h$ is simply a variable, and $dx$ is simply a variable, we can replace $h$ with $dx$ to write
\begin{align*}
f'(x)\cdot dx &\approx f(x+dx)-f(x)\\
dy &\approx f(x+dx)-f(x).
\end{align*}
From this we see that 
\[
f(x+dx)\approx dy + f(x).
\]
While this is something of a ``slight-of-hand'' with variables, there
are contexts where the language of differentials is common. We will
repeat our previous examples using differentials.

\begin{example}
Use differentials to approximate $\sqrt[3]{50}$.
\end{example}

\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=1,xmax=100,ymin=2,ymax=5,
            axis lines=center,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=150,smooth,domain=(0:100)] {x^(1/3))};
          \addplot [very thick, penColor2, domain=(50:64)] {x/48+8/3};
          \addplot [textColor,dashed] plot coordinates {(64,0) (64,4)};
          \node at (axis cs:20,2.3) [penColor] {$f(x)$};
          \addplot [penColor2,very thick] plot coordinates {(64,4) (64,3.71)};
          \addplot [penColor2,very thick] plot coordinates {(50,3.71) (64,3.71)};
          \node [below] at (axis cs:57,3.7) [penColor2] {$dx$};
          \node [right] at (axis cs:64,3.8) [penColor2] {$dy$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(64,4)};  %% closed hole            
        \end{axis}
\end{tikzpicture}
\caption{A plot of $f(x) = \sqrt[3]{x}$  along with the differentials $dx$ and
  $dy$.}
\label{figure:diff sqrt3x}
\end{marginfigure}


\begin{solution}
Since $4^3 = 64$ is a perfect cube near $50$, we will set $dx=-14$. In this case
\[
\frac{dy}{dx} = f'(x)  = \frac{1}{3x^{2/3}}
\]
hence 
\begin{align*}
dy &= \frac{1}{3x^{2/3}} \cdot dx\\
&= \frac{1}{3\cdot64^{2/3}} \cdot(-14)\\
&= \frac{1}{3\cdot64^{2/3}} \cdot(-14)\\
&= \frac{-7}{24}
\end{align*}
Now $f(50) \approx f(64) + \frac{-7}{24} \approx 3.71$.
\end{solution}


\begin{example}
Use differentials to approximate $\sin(0.3)$.
\end{example}

\begin{marginfigure}
\begin{tikzpicture}
	\begin{axis}[
            xmin=-1.6,xmax=1.6,ymin=-1.5,ymax=1.5,
            axis lines=center,
            xtick={-1.57, 0, 1.57},
            xticklabels={$-\pi/2$, $0$, $\pi/2$},
            ytick={-1,1},
            %ticks=none,
            %width=3in,
            %height=2in,
            unit vector ratio*=1 1 1,
            xlabel=$x$, ylabel=$y$,
            every axis y label/.style={at=(current axis.above origin),anchor=south},
            every axis x label/.style={at=(current axis.right of origin),anchor=west},
          ]        
          \addplot [very thick, penColor, samples=100,smooth, domain=(-1.6:1.6)] {sin(deg(x))};
          \addplot [very thick, penColor2, domain={0:0.3}] {x};
          \addplot [penColor2,very thick] plot coordinates {(0,0) (.3,0)};
          \addplot [penColor2,very thick] plot coordinates {(.3,0) (.3,.3)};
          \node at (axis cs:1,.6) [penColor] {$f(x)$};
          \node [below] at (axis cs:.15,.0) [penColor2] {$dx$};
          \node [right] at (axis cs:.3,.15) [penColor2] {$dy$};
          \addplot[color=penColor3,fill=penColor3,only marks,mark=*] coordinates{(0,0)};  %% closed hole          
        \end{axis}
\end{tikzpicture}
\caption{A plot of $f(x) = \sin(x)$ along with the differentials $dx$ and
  $dy$.}
\label{figure:diff sin}
\end{marginfigure}


\begin{solution}
Since $\sin(0) = 0$, we will set $dx=0.3$. In this case
\[
\frac{dy}{dx} = f'(x)  = \cos(x)
\]
hence 
\begin{align*}
dy &= \cos(1) \cdot dx\\
&= 1 \cdot (0.3)\\
&= 0.3
\end{align*}
Now $f(.3) \approx f(0) + 0.3 \approx 0.3$.
\end{solution}

The upshot is that linear approximations and differentials are simply
two slightly different ways of doing the exact same thing.





\begin{exercises}

\begin{exercise}
Use a linear approximation of $f(x) =\sin(x/2)$ at $x=0$ to approximate
$f(0.1)$.
\begin{answer}
$\sin(0.1/2)\approx 0.05$
\end{answer}
\end{exercise}

\begin{exercise}
Use a linear approximation of $f(x) =\sqrt[3]{x}$ at $x=8$ to approximate
$f(10)$.
\begin{answer}
$\sqrt[3]{10}\approx 2.17$
\end{answer}
\end{exercise}

\begin{exercise}
Use a linear approximation of $f(x) =\sqrt[5]{x}$ at $x=243$ to approximate
$f(250)$.
\begin{answer}
$\sqrt[5]{250}\approx 3.017$
\end{answer}
\end{exercise}


\begin{exercise}
Use a linear approximation of $f(x) =\ln(x)$ at $x=1$ to approximate
$f(1.5)$.
\begin{answer}
$\ln(1.5)\approx 0.5$
\end{answer}
\end{exercise}

\begin{exercise}
Use a linear approximation of $f(x) =\ln(\sqrt{x})$ at $x=1$ to approximate
$f(1.5)$.
\begin{answer}
$\ln(\sqrt{1.5})\approx 0.25$
\end{answer}
\end{exercise}


\begin{exercise} 
Let $f(x) = \sin(x/2)$. If $x=1$ and $dx=1/2$, what is $dy$?
\begin{answer} $dy=2$
\end{answer}\end{exercise}

\begin{exercise} 
Let $f(x) = \sqrt{x}$. If $x=1$ and $dx =1/10$, what is $dy$?
\begin{answer} $dy=0.05$
\end{answer}\end{exercise}

\begin{exercise} 
Let $f(x) = \ln(x)$. If $x=1$ and $dx =1/10$, what is $dy$?
\begin{answer} $dy=0.1$
\end{answer}\end{exercise}


\begin{exercise} 
Let $f(x) = \sin (2x)$. If $x=\pi$ and $dx=\pi/100$, what is $dy$?
\begin{answer} $dy=\pi/50$
\end{answer}\end{exercise}

\begin{exercise} Use differentials to estimate the amount of paint needed to
 apply a coat of paint 0.02 cm thick to a sphere with diameter $40$
 meters. Hint: Recall that the volume of a sphere of radius $r$ is $V
 =(4/3)\pi r^3$. Notice that you are given that $dr=0.02$.
\begin{answer} $dV=8\pi/25$
\end{answer}\end{exercise}

\end{exercises}












\section{Newton's Method}

Suppose you have a function $f(x)$, and you want to find as accurately as
possible where it crosses the $x$-axis; in other words, you want to solve
$f(x)=0$.  Suppose you know of no way to find an exact solution by any
algebraic procedure, but you are able to use an approximation,
provided it can be made quite close to the true value.
Newton's method is a way to find a solution to the
equation to as many decimal places as you want.  It is what is called an
``iterative procedure,'' meaning that it can be repeated again and again to
get an answer of greater and greater accuracy.  Iterative procedures like
Newton's method are well suited to programming for a
computer. Newton's method uses the fact that the tangent line to a
curve is a good approximation to the curve near the point of tangency.

\begin{example} Approximate $\sqrt{3}$. Since $\sqrt{3}$ is a solution to
$x^2=3$ or $x^2-3=0$, we use $f(x)=x^2-3$. We start by guessing
something reasonably close to the true value; this is usually easy to
do; let's use $\sqrt3\approx2$. Now use the tangent line to the curve
when $x=2$ as an approximation to the curve, as shown in
figure~\xrefn{fig:newtons method}. Since $f'(x)=2x$, the slope of this
tangent line is 4 and its equation is $y=4x-7$. The tangent line is
quite close to $f(x)$, so it crosses the $x$-axis near the point at
which $f(x)$ crosses, that is, near $\sqrt3$. It is easy to find where
the tangent line crosses the $x$-axis: solve $0=4x-7$ to get
$x=7/4=1.75$. This is certainly a better approximation than 2, but let
us say not close enough. We can improve it by doing the same thing
again: find the tangent line at $x=1.75$, find where this new tangent
line crosses the $x$-axis, and use that value as a better
approximation. We can continue this indefinitely, though it gets a bit
tedious. Lets see if we can shortcut the process. Suppose the best
approximation to the intercept we have so far is $x_i$. To find a
better approximation we will always
do the same thing: find the slope of the tangent line at $x_i$, find the
equation of the tangent line, find the $x$-intercept. The slope is
$2x_i$. The tangent line is $y=(2x_i)(x-x_i)+(x_i^2-3)$, using
the point-slope formula for a line. Finally, the intercept is found by
solving $0 =(2x_i)(x-x_i)+(x_i^2-3)$. With a little algebra this turns
into $x=(x_i^2+3)/(2x_i)$; this is the next approximation, which we
naturally call $x_{i+1}$. Instead of doing the whole tangent line
computation every time we can simply use this formula to get as many
approximations as we want. Starting with $x_0=2$, we get
$x_1=(x_0^2+3)/(2x_0)=(2^2+3)/4=7/4$ (the same approximation we got
above, of course), $x_2=(x_1^2+3)/(2x_1)=
((7/4)^2+3)/(7/2)=97/56\approx 1.73214$, $x_3\approx 1.73205$, and so
on. This is still a bit tedious by hand, but with a calculator or,
even better, a good computer program, it is quite easy to get many,
many approximations. We might guess already that $1.73205$ is accurate
to two decimal places, and in fact it turns out that it is accurate to
5 places.  \end{example}

%% BADBAD
%% \figure
%% \vbox{\beginpicture
%% \normalgraphs
%% \sevenpoint
%% \setcoordinatesystem units <1.5truecm,0.6truecm>
%% \setplotarea x from 0 to 4, y from -4 to 7
%% \axis left /
%% \axis bottom shiftedto y=0 ticks numbered from 1 to 2 by 1 /
%% \plot 0.000 -3.000 0.150 -2.978 0.300 -2.910 0.450 -2.798 0.600 -2.640 
%% 0.750 -2.438 0.900 -2.190 1.050 -1.898 1.200 -1.560 1.350 -1.178 
%% 1.500 -0.750 1.650 -0.278 1.800 0.240 1.950 0.802 2.100 1.410 
%% 2.250 2.062 2.400 2.760 2.550 3.502 2.700 4.290 2.850 5.122 
%% 3.000 6.000 /
%% \setlinear
%% \plot 1 -3 3.5 7 /
%% \endpicture}
%% \figrdef{fig:newtons method}
%% \endfigure{Newton's method.
%% (\expandafter\url\expandafter{\liveurl jsxgraph/newtons_method.html}%
%% AP\endurl)}

Let's think about this process in more general terms. We want to
approximate a solution to $f(x)=0$.
We start with a rough guess, which we call $x_0$.  We use the tangent
line to $f(x)$ to get a new approximation that we hope will be closer
to the true value. What is the equation of the tangent line when
$x=x_0$? The slope is $f'(x_0)$ and the line goes through
$\ds(x_0,f(x_0))$, so the equation of the line is
$$ y=f'(x_0)(x-x_0)+f(x_0).$$
Now we find where this crosses the $x$-axis by substituting $y=0$ and
solving for $x$:
$$x={x_0f'(x_0)-f(x_0)\over f'(x_0)} = x_0 - {f(x_0)\over f'(x_0)}.$$
We will typically want to compute more than one of these improved
approximations, so we number them consecutively; from $x_0$ we have
computed $x_1$:
$$x_1={x_0f'(x_0)-f(x_0)\over f'(x_0)} = x_0 - {f(x_0)\over f'(x_0)},$$
and in general from $x_i$ we compute $x_{i+1}$:
$$x_{i+1}={x_if'(x_i)-f(x_i)\over f'(x_i)} = x_i - {f(x_i)\over f'(x_i)}.$$

\begin{example}
Returning to the previous example, $f(x)=x^2-3$, $f'(x)=2x$, and the
formula becomes $x_{i+1}=x_i - (x_i^2-3)/(2x_i)=(x_i^2+3)/(2x_i)$, as
before.
\end{example}

In practice, which is to say, if you need to approximate a value in
the course of designing a bridge or a building or an airframe, you
will need to have some confidence that the approximation you settle on
is accurate enough. As a rule of thumb, once a certain number of
decimal places stop changing from one approximation to the next it is
likely that those decimal places are correct. Still, this may not be
enough assurance, in which case we can test the result for accuracy.

\begin{example} Find the $x$ coordinate of the intersection of the curves $y=2x$
and $y=\tan x$, accurate to three decimal places. To put this in the
context of Newton's method, we note that we want to know where $2x=\tan
x$ or $f(x)=\tan x-2x=0$. We compute $f'(x)=\sec^2 x - 2$ and set up the
formula:
$$x_{i+1} = x_i-{\tan x_i -2x_i\over \sec^2 x_i - 2}.$$ From the graph
in figure~\xrefn{fig:tanx vs x} 
we guess $x_0=1$ as a starting point, then using the formula we
compute $x_1=1.310478030$, $x_2=1.223929096$, $x_3=1.176050900$,
$x_4=1.165926508$, $x_5=1.165561636$.  So we guess that the first
three places are correct, but that is not the same as saying $1.165$
is correct to three decimal places---$1.166$ might be the correct,
rounded approximation. How can we tell? We can substitute $1.165$,
$1.1655$ and $1.166$ into $\tan x - 2x$; this
gives $-0.002483652$, $-0.000271247$, $0.001948654$. Since the first
two are negative and the third is positive, $\tan x - 2x$ crosses the
$x$ axis between $1.1655$ and $1.166$, so the correct value to three
places is $1.166$.
\end{example}

%% BADBAD
%% \figure
%% \vbox{\beginpicture
%% \normalgraphs
%% \sevenpoint
%% \setcoordinatesystem units <3truecm,0.25truecm>
%% \setplotarea x from 0 to 1.5, y from 0 to 15
%% \axis left ticks numbered from 0 to 15 by 5 /
%% \axis bottom shiftedto y=0 ticks length <2pt> withvalues {$1$} {$1.5$} / at
%% 1 1.5 / /
%% \plot 0.000 0.000 0.038 0.038 0.075 0.075 0.112 0.113 0.150 0.151 
%% 0.188 0.190 0.225 0.229 0.262 0.269 0.300 0.309 0.338 0.351 
%% 0.375 0.394 0.412 0.438 0.450 0.483 0.488 0.530 0.525 0.579 
%% 0.562 0.630 0.600 0.684 0.638 0.741 0.675 0.800 0.712 0.864 
%% 0.750 0.932 0.788 1.004 0.825 1.083 0.862 1.167 0.900 1.260 
%% 0.938 1.362 0.975 1.475 1.012 1.601 1.050 1.743 1.088 1.905 
%% 1.125 2.093 1.162 2.312 1.200 2.572 1.238 2.888 1.275 3.282 
%% 1.312 3.785 1.350 4.455 1.388 5.394 1.425 6.810 1.462 9.198 
%% 1.500 14.101  /
%% \setlinear
%% \plot 0 0 1.5 3 /
%% \setcoordinatesystem units <3truecm,0.25truecm> point at -2.5 0
%% \setplotarea x from 0 to 1.5, y from 0 to 15
%% \axis left ticks numbered from 0 to 15 by 5 /
%% \axis bottom shiftedto y=0 ticks length <2pt> withvalues {$1$} {$1.5$} / at
%% 1 1.5 / /
%% \plot 0.000 -0.000 0.037 -0.037 0.075 -0.075 0.113 -0.112 0.150 -0.149
%% 0.188 -0.185 0.225 -0.221 0.263 -0.256 0.300 -0.291 0.338 -0.324
%% 0.375 -0.356 0.412 -0.387 0.450 -0.417 0.487 -0.445 0.525 -0.471
%% 0.562 -0.495 0.600 -0.516 0.637 -0.534 0.675 -0.550 0.713 -0.561
%% 0.750 -0.568 0.787 -0.571 0.825 -0.567 0.863 -0.558 0.900 -0.540
%% 0.938 -0.513 0.975 -0.475 1.012 -0.424 1.050 -0.357 1.087 -0.270
%% 1.125 -0.157 1.163 -0.013 1.200 0.172 1.238 0.413 1.275 0.732
%% 1.312 1.160 1.350 1.755 1.387 2.619 1.425 3.960 1.462 6.273
%% 1.500 11.101 /
%% \endpicture}
%% \figrdef{fig:tanx vs x}
%% \endfigure{$y=\tan x$ and $y=2x$ on the left, $y=\tan x-2x$ on the right.}

\begin{exercises}

\begin{exercise} Approximate the fifth root of 7, using $x_0=1.5$ as a
first guess. Use Newton's method to find $x_3$ as your
approximation.  
\begin{answer} $x_3=1.475773162$ 
\end{answer}\end{exercise}

\begin{exercise} Use Newton's Method to approximate the cube root of 10 to
two decimal places.
\begin{answer} $2.15$
\end{answer}\end{exercise}

\begin{exercise} The function 
$f(x)=x^3-3x^2-3x+6$ has a root between 3 and 4, because
$f(3)=-3$ and $f(4)=10$. Approximate the root to two decimal places.
\begin{answer}  $3.36$
\end{answer}\end{exercise}

\begin{exercise} A rectangular piece of cardboard of dimensions $8\times 17$
is used to make an open-top box by cutting out a small square of side
$x$ from each corner and bending up the sides.  (See
exercise~\xrefn{sec:optimization}.\xrefn{exercise: cardboard box}.)
If $x=2$, then the volume of the box is $2\cdot 4\cdot 13=104$.  Use
Newton's method to find a value of $x$ for which the box has volume
100, accurate to 3 significant figures.  
\begin{answer} $2.19$ or $1.26$
\end{answer}\end{exercise}

% Mike Wills stuff
% \iflatetranscendentals
% 
% \begin{remark} {Further investigation} Newton's method does not always
% work. The following result gives sufficient conditions for when it
% does.  \end{remark}
% 
% \begin{theorem} (Newton) Let $f:[a,b] \rightarrow \R$ be continuous. Suppose that
% $f(c) =0$ for some $c$ in $(a,b)$.  Suppose that $f''$ exists and is
% bounded on $(a,b)$; that is, there exists $M>0$ such that
% $$f''(x) \leq M $$ 
% for every $x\in (a,b)$.
% 
% Suppose that $f'$ is bounded away from zero; that is, there exists
% $\epsilon >0$ such that
% $$f'(x) \geq \epsilon $$ for every $x \in (a,b)$. Then there is a
% closed interval $I:=[d,e] \subset (a,b)$ containing $c$ such that
% the sequence given recursively by
% $$x_n = x_{n-1} -f(x_{n-1})/f'(x_{n -1}) $$ converges to
% $c$. Moreover, $x_n$ is in $I$ for each $n$.
% \end{proof}
% 
% \noindent
% For this to make sense it helps if we have a notion of convergence of
% sequences. We will do this in second semester calculus. For now, we
% will just use the intuitive statement ``as $n$ gets large, $x_n$ gets
% arbitrarily close to $c$" and write 
% $\displaystyle{\lim _{n\rightarrow\infty } x_n }= c$.
% 
% \noindent
% Let us now analyze the various conditions in the statement.
% 
% \noindent
% Bounding $f'$ away from zero should seem reasonable from the
% definition of $x_n$ but it is not necessary. The following
% exercise shows that Newton's method may work even if $f'$ is not
% bounded away from zero.
% 
% \begin{exercise} Let $f(x) = x^2$. Adopt the notation of Newton's
% theorem. Show that if $x_{n-1 } \neq 0$ then $x_n
% =x_{n-1}/2$. Suppose that $x_0 = 1.$ What is $x_1$? How about
% $x_2$? How about $x_n$? Argue that $x_n$ converges to zero
% as $n$ goes to $\infty$ when $x_0 =1$.
% 
% \noindent
% In the above example, any $x_0$ except zero will do.  The next
% exercise illustrates what can go wrong if we do not bound $f'$ away
% from zero.
% 
% \begin{exercise} Let $f(x) = x^4 - 4x - 11$. Then $f(0)<0 < f(3)$ so by
% the intermediate value theorem there exists a root between $x=0$ and
% $x=3$. What happens if we apply Newton's method when we start at $\ds
% x_0 =1$?  Sketch the graph of $f$ on the interval $[0,3]$.
%  
% \noindent
% We also require a bound on the second derivative. The following
% exercise shows what can go wrong.
% 
% \begin{exercise} Let $f(x) = x^{1/3}$. Observe that $x=0$ is a root of
% $f$.  Compute $f''(x)$ and explain why $f''$ is unbounded near
% $x=0$. Attempt to use Newton's method with $x_0 = 1$.  What
% happens? Illustrate your conclusion with a diagram.
%  
% \noindent
% Newton's method, when it works, is extremely fast. The number of
% decimal places of accuracy approximately doubles with each successive
% iteration.
%  
% \noindent
% The statement of Newton's theorem does not tell us how to how to find
% the closed interval $I$. The proof gives some indication but is beyond
% the scope of the course.
%  
% \noindent
% For our purposes, we can use a graphing calculator to give us an idea
% of where to look for the roots of a given function and then apply
% Newton's method to get a good decimal approximation.
%  
% \begin{exercise} Use Newton's method to find the coordinates of the
% inflection point of $y=x^3/12 + \sin x$ correct to six decimal
% places.
%  
% \begin{exercise} Let $a$ be a non-zero number. Suppose we want to compute a
% decimal expansion of $1/a$.  This could be difficult if $a$ is big or
% has a large number of decimal places. Newton's method gives us a way
% of computing $a$ without division.  Let $f(x) = 1/x - a$. Notice that
% $f$ has a root at $x=1/a$.  Using the notation of Newton's theorem,
% show that $x_{n} =2x_{n-1} - ax_{n-1}^2$.
%  
% \fi

\end{exercises}







\section{Euler's Method}











\section{The Mean Value Theorem}

Here are two interesting questions involving derivatives:

\begin{itemize} % BADBAD

\item{1.} Suppose two different functions have the same derivative;
  what can you say about the relationship between the two functions?

\item{2.} Suppose you drive a car from toll booth on a toll road to
  another toll booth at an
  average speed of 70 miles per hour. What can be concluded about your
  actual speed during the trip? In particular, did you exceed the 65
  mile per hour speed limit?

\end{itemize}

While these sound very different, it turns out that the two problems
are very closely related. We know that ``speed'' is really the
derivative by a different name; let's start by translating the second
question into something that may be easier to visualize. Suppose that
the function $f(t)$ gives the position of your car on the toll road at
time $t$. Your change in position between one toll booth and the next
is given by $f(t_1)-f(t_0)$, assuming that at time $t_0$ you were at
the first booth and at time $t_1$ you arrived at the second
booth. Your average speed for the trip is
$(f(t_1)-f(t_0))/(t_1-t_0)$. If we think about the graph of $f(t)$,
the average speed is the slope of the line that connects the two
points $(t_0,f(t_0))$ and $(t_1,f(t_1))$. Your speed at any particular time
$t$ between $t_0$ and $t_1$ is $f'(t)$, the slope of the curve. Now
question (2) becomes a question about slope. In particular, if the
slope between endpoints is 70, what can be said of the slopes at
points between the endpoints?

As a general rule, when faced with a new problem it is often a good idea to
examine one or more simplified versions of the problem, in the hope
that this will lead to an understanding of the original problem.
In this case, the problem in its ``slope'' form is somewhat easier to
simplify than the original, but equivalent, problem.

Here is a special instance of the problem. Suppose that
$f(t_0)=f(t_1)$. Then the two endpoints have the same height and the
slope of the line connecting the endpoints is zero. What can we say
about the slope between the endpoints? It shouldn't take much
experimentation before you are convinced of the truth of this
statement: Somewhere between $t_0$ and $t_1$ the slope is exactly
zero, that is, somewhere between $t_0$ and $t_1$ the slope is equal to
the slope of the line between the endpoints. This suggests that
perhaps the same is true even if the endpoints are at different
heights, and again a bit of experimentation will probably convince you
that this is so. But we can do better than ``experimentation''---we
can prove that this is so.

We start with the simplified version:

\begin{theorem} (Rolle's Theorem) Suppose that $f(x)$ has a derivative on the
interval $(a,b)$, is continuous on the interval $[a,b]$, and
$f(a)=f(b)$. Then at some value $c\in (a,b)$, $f'(c)=0$.
\index{Rolle's Theorem}
\label{thm:rolle}
\end{theorem}

\begin{proof}
We know that $f(x)$ has a maximum and minimum value on $[a,b]$
(because it is continuous), and we
also know that the maximum and minimum must occur at an endpoint, at a
point at which the derivative is zero, or at a point where the
derivative is undefined. Since the derivative is never undefined, that
possibility is removed.

If the maximum or minimum occurs at a point $c$, other than an endpoint,
where $f'(c)=0$, then we have found the point we seek. Otherwise, the
maximum and minimum both occur at an endpoint, and since the endpoints
have the same height, the maximum and minimum are the same. This means
that $f(x)=f(a)=f(b)$ at every $x \in [a,b]$, so the function is a
horizontal line, and it has derivative zero everywhere in
$(a,b)$. Then we may choose any $c$ at all to get $f'(c)=0$.
\end{proof}

Perhaps remarkably, this special case is all we need to prove the more
general one as well.

\begin{theorem} (Mean Value Theorem) 
\label{thm:mvt}
Suppose that $f(x)$ has a derivative on the
interval $(a,b)$ and is continuous on the interval $[a,b]$. 
Then at some value
$c\in (a,b)$, $f'(c)={f(b)-f(a)\over b-a}$.
\index{Mean Value Theorem}
\end{theorem}

\begin{proof}
Let $m={f(b)-f(a)\over b-a}$, and consider a new function
$g(x)=f(x) - m(x-a)-f(a)$. We know that $g(x)$ has a derivative
everywhere, since $g'(x)=f'(x)-m$. We can compute 
$g(a)=f(a)- m(a-a)-f(a) =0$ and
\begin{align*}
g(b)=f(b)-m(b-a)-f(a)&=f(b)-{f(b)-f(a)\over b-a}(b-a)-f(a) \\
&=f(b)-(f(b)-f(a))-f(a)=0. 
\end{align*}
So the height of $g(x)$ is the same at both endpoints. This means, by
Rolle's Theorem, that at some $c$, $g'(c)=0$. But we know that
$g'(c)=f'(c)-m$, so
$$0=f'(c)-m=f'(c)-{f(b)-f(a)\over b-a},$$
which turns into
$$f'(c)={f(b)-f(a)\over b-a},$$
exactly what we want.
\end{proof}

Returning to the original formulation of question (2), we see that if
$f(t)$ gives the position of your car at time $t$, then the Mean Value
Theorem says that at some time $c$, $f'(c)=70$, that is, at some time
you must have been traveling at exactly your average speed for the
trip, and that indeed you exceeded the speed limit.

Now let's return to question (1). Suppose, for example, that two
functions are known to have derivative equal to 5 everywhere,
$f'(x)=g'(x)=5$. It is easy to find such functions: $5x$, $5x+47$,
$5x-132$, etc. Are there other, more complicated, examples? No---the
only functions that work are the ``obvious'' ones, namely, $5x$ plus
some constant. How can we see that this is true?

Although ``5'' is a very simple derivative, let's look at an even
simpler one. Suppose that $f'(x)=g'(x)=0$. Again we can find examples:
$f(x)=0$, $f(x)=47$, $f(x)=-511$ all have $f'(x)=0$. Are there
non-constant functions $f$ with derivative 0? No, and here's why:
Suppose that $f(x)$ is not a constant function. This means that there
are two points on the function with different heights, say
$f(a)\not=f(b)$. The Mean Value Theorem tells us that at some point
$c$, $f'(c)=(f(b)-f(a))/(b-a)\not=0$. So any non-constant function
does not have a derivative that is zero everywhere; this is the same
as saying that the only functions with zero derivative are the
constant functions.

Let's go back to the slightly less easy example: suppose that 
$f'(x)=g'(x)=5$. Then $(f(x)-g(x))' = f'(x)-g'(x) = 5 -5 =0$. So using
what we discovered in the previous paragraph, we know that
$f(x)-g(x)=k$, for some constant $k$. So any two functions with
derivative 5 must differ by a constant; since $5x$ is known to work,
the only other examples must look like $5x+k$.

Now we can extend this to more complicated functions, without any
extra work. Suppose that $f'(x)=g'(x)$. Then as before
$(f(x)-g(x))' = f'(x)-g'(x) =0$, so $f(x)-g(x)=k$. Again this means
that if we find just a single function $g(x)$ with a certain
derivative, then every other function with the same derivative must be
of the form $g(x)+k$.

\begin{example}
Describe all functions that have derivative $5x-3$. It's easy to find
one: $g(x)=(5/2)x^2-3x$ has $g'(x)=5x-3$. The only other functions
with the same derivative are therefore of the form
$f(x)=(5/2)x^2-3x+k$.

Alternately, though not obviously, you might have first noticed that 
$g(x)=(5/2)x^2-3x+47$ has $g'(x)=5x-3$. Then every other function
with the same derivative must have the form $f(x)=(5/2)x^2-3x+47+k$.
This looks different, but it really isn't. The functions of the form
$f(x)=(5/2)x^2-3x+k$ are exactly the same as the ones of the form
$f(x)=(5/2)x^2-3x+47+k$. For example, $(5/2)x^2-3x+10$ is the same as
$(5/2)x^2-3x+47+(-37)$, and the first is of the first form while
the second has the second form.
\end{example}

This is worth calling a theorem:

\begin{theorem} If $f'(x)=g'(x)$ for every $x\in (a,b)$, then for some constant
$k$, $f(x)=g(x)+k$ on the interval $(a,b)$.
\end{theorem}

\begin{example}
Describe all functions with derivative $\sin x$. One such
function is $-\cos x$, so all such functions have the form
$-\cos x+k$.
\end{example}



\begin{example}
Describe all functions with derivative $\sin x + e^x$. One such
function is $-\cos x+e^x$, so all such functions have the form
$-\cos x+e^x+k$.
\end{example}

\begin{exercises}

\begin{exercise} Let $f(x) = x^2$.
Find a value $c\in (-1,2)$ so that $f'(c)$ equals the slope between
the endpoints of $f(x)$ on $[-1,2]$.
\begin{answer} $c=1/2$
\end{answer}\end{exercise}

\begin{exercise} Verify that $f(x) = x/(x+2)$ satisfies the hypotheses of the
 Mean Value Theorem on the interval $[1,4]$ and then find all of the
 values, $c$, that satisfy the conclusion of the theorem.
\begin{answer} $c=\sqrt{18}-2$
\end{answer}\end{exercise}

\begin{exercise}
Verify that $f(x) = 3x/(x+7)$ satisfies the hypotheses of the
 Mean Value Theorem on the interval $[-2 , 6]$ and then find all of the
 values, $c$, that satisfy the conclusion of the theorem.
\end{exercise}

\begin{exercise} Let $f(x) = \tan x $. Show that $f(\pi ) = f(2\pi)=0$ but
there is no number $c\in (\pi,2\pi)$ such that $f'(c) =0$. Why does
this not contradict Rolle's theorem?
\end{exercise}

\begin{exercise} Let $f(x) = (x-3)^{-2}$.  Show that there is no value 
$c\in (1,4)$ such that $f'(c) = (f(4)-f(1))/(4-1)$.  Why is
this not a contradiction of the Mean Value Theorem?
\end{exercise}

\begin{exercise} Describe all functions with derivative $x^2+47x-5$.
\begin{answer} $x^3/3+47x^2/2-5x+k$
\end{answer}\end{exercise}

\begin{exercise} Describe all functions with derivative ${1\over 1+x^2}$.
\begin{answer} $\arctan x + k$
\end{answer}\end{exercise}

\begin{exercise} Describe all functions with derivative $x^3-{1\over x}$.
\begin{answer} $x^4/4 -\ln x +k$
\end{answer}\end{exercise}


\begin{exercise} Describe all functions with derivative $\sin(2x)$.
\begin{answer} $-\cos(2x)/2 +k$
\end{answer}\end{exercise}

\begin{exercise} Show that the equation $6x^4 -7x+1 =0$ does not have more
than two distinct real roots.
\end{exercise}

\begin{exercise} Let $f$ be differentiable on $\R$. Suppose that $f'(x) \neq
0$ for every $x$. Prove that $f$ has at most one real root.
\end{exercise}
 
\begin{exercise} Prove that for all real $x$ and $y$
$|\cos x -\cos y | \leq |x-y|$.
State and prove an analogous result involving sine.
\end{exercise}

\begin{exercise}
Show that
$\sqrt{1+x} \le 1 +(x/2)$ if $-1<x<1$.
\end{exercise}

\end{exercises}

