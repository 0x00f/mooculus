
\chapter{The Chain Rule}

So far we have seen how to compute the derivative of a function built
up from other functions by addition, subtraction, multiplication and
division. There is another very important way that we combine
functions: composition. The \textit{chain rule} allows us to deal with
this case.

\section{The Chain Rule}


Consider $\sqrt{625-x^2}$. This function has many simpler
components, like $625$ and $x^2$, and then there is that square root
symbol, so the square root function $\sqrt{x}=x^{1/2}$ is
involved. The obvious question is: can we compute the derivative using
the derivatives of the constituents $625-x^2$ and $\sqrt{x}$?
We can indeed. In general, if $f(x)$ and $g(x)$ are functions, we can
compute the derivatives of $f(g(x))$ and $g(f(x))$ in terms of $f'(x)$
and $g'(x)$.

\begin{example} Form the two possible compositions of $f(x)=\sqrt{x}$ and
$g(x)=625-x^2$ and compute the derivatives.  First,
  $f(g(x))=\sqrt{625-x^2}$, and the derivative is $-x/\sqrt{625-x^2}$
  as we have seen. Second, $g(f(x))=625-(\sqrt{x})^2=625-x$ with
  derivative $-1$. Of course, these calculations do not use anything
  new, and in particular the derivative of $f(g(x))$ was somewhat
  tedious to compute from the definition.
\end{example}

Suppose we want the derivative of $f(g(x))$.
Again, let's set up the derivative and play some algebraic tricks:
\begin{align*}
\ddx f(g(x)) &=\lim_{h\to0} \frac{f(g(x+h))-f(g(x))}{h} \\
&=\lim_{h\to0} \frac{f(g(x+h))-f(g(x))}{g(x+h))-g(x)} \frac{g(x+h))-g(x)}{h} \\
\end{align*}
Now we see immediately that the second fraction turns into $g'(x)$
when we take the limit. The first fraction is more complicated, but it
too looks something like a derivative. The denominator, $g(x+h))-g(x)$, is a change in the value of $g(x)$, so let's abbreviate
it as $\Delta g=g(x+h))-g(x)$, which also means $g(x+h)=g(x)+\Delta g$. This gives
us
\[
\lim_{h\to0} {f(g(x)+\Delta g)-f(g(x))\over \Delta g}.
\]
As $h$ goes to 0, it is also true that $\Delta g$ goes to 0,
because $g(x+h)$ goes to $g(x)$. So we can rewrite this limit
as
$$\lim_{\Delta g\to0} {f(g(x)+\Delta g)-f(g(x))\over \Delta g}.$$
Now this looks exactly like a derivative, namely $f'(g(x))$, that is,
the function $f'(x)$ with $x$ replaced by $g(x)$. If this all
withstands scrutiny, we then get
$${d\over dx}f(g(x))=f'(g(x))g'(x).$$
Unfortunately, there is a small flaw in the argument. Recall that what
we mean by $\lim_{h\to0}$ involves what happens when $h$
is close to 0 {\it but not equal to 0.} The qualification is very
important, since we must be able to divide by $h$.
But when $h$ is close to 0 but not equal to 0,
$\Delta g=g(x+\Delta
x))-g(x)$ is close to 0 {\it and possibly equal to 0.} This means it
doesn't really make sense to divide by $\Delta g$.
Fortunately, it is possible to recast the argument to avoid this
difficulty, but it is a bit tricky; we will not include the details,
which can be found in many calculus books. Note that many functions
$g$ do have the property that $g(x+h)-g(x)\not=0$ when $\Delta
x$ is small, and for these functions the argument above is fine.

The chain rule has a particularly simple expression if we use the
Leibniz notation for the derivative. The quantity $f'(g(x))$ is the
derivative of $f$ with $x$ replaced by $g$; this can be written 
$df/dg$. As usual, $g'(x)=dg/dx$. Then the chain rule becomes
$${df\over dx} = {df\over dg}{dg\over dx}.$$
This looks like trivial arithmetic, but it is not: $dg/dx$ is not a
fraction, that is, not literal division, but a single symbol that
means $g'(x)$. Nevertheless, it turns out that what looks like trivial
arithmetic, and is therefore easy to remember, is really true.

It will take a bit of practice to make the use of the chain rule come
naturally---it is more complicated than the earlier differentiation
rules we have seen.

\begin{example}
Compute the derivative of $\sqrt{625-x^2}$. We already know that the
answer is $-x/\sqrt{625-x^2}$, computed directly from the limit. In
the context of the chain rule, we have $f(x)=\sqrt{x}$,
$g(x)=625-x^2$. We know that $f'(x)=(1/2)x^{-1/2}$, so $f'(g(x))=
(1/2)(625-x^2)^{-1/2}$. Note that this is a two step computation:
first compute $f'(x)$, then replace $x$ by $g(x)$. Since $g'(x)=-2x$
we have
$$f'(g(x))g'(x)={1\over 2\sqrt{625-x^2}}(-2x)={-x\over
    \sqrt{625-x^2}}.
$$
\vskip-10pt
\end{example}

\begin{example}
Compute the derivative of $1/\sqrt{625-x^2}$. This is a quotient with
a constant numerator, so we could use the quotient rule, but it is
simpler to use the chain rule. The function is $(625-x^2)^{-1/2}$, the
composition of $f(x)=x^{-1/2}$ and $g(x)=625-x^2$. We compute
$f'(x)=(-1/2)x^{-3/2}$ using the power rule, and then
$$f'(g(x))g'(x)={-1\over 2(625-x^2)^{3/2}}(-2x)={x\over (625-x^2)^{3/2}}.
$$
\vskip-10pt
\end{example}

In practice, of course, you will need to use more than one of the
rules we have developed to compute the derivative of a complicated
function.

\begin{example}
Compute the derivative of $$f(x)={x^2-1\over x\sqrt{x^2+1}}.$$
The ``last'' operation here is division, so to get started we need to
use the quotient rule first. This gives
\begin{align*}
f'(x)&={(x^2-1)'x\sqrt{x^2+1}-(x^2-1)(x\sqrt{x^2+1})'\over
x^2(x^2+1)} \\
&={2x^2\sqrt{x^2+1}-(x^2-1)(x\sqrt{x^2+1})'\over
x^2(x^2+1)}. \\
\end{align*}
Now we need to compute the derivative of $x\sqrt{x^2+1}$. This is a
product, so we use the product rule:
$${d\over dx}x\sqrt{x^2+1}=x{d\over dx}\sqrt{x^2+1}+\sqrt{x^2+1}.$$
Finally, we use the chain rule:
$${d\over dx}\sqrt{x^2+1}={d\over dx}(x^2+1)^{1/2}=
{1\over 2}(x^2+1)^{-1/2}(2x)={x\over \sqrt{x^2+1}}.$$
And putting it all together:
\begin{align*}
f'(x)&={2x^2\sqrt{x^2+1}-(x^2-1)(x\sqrt{x^2+1})'\over
x^2(x^2+1)}. \\
&={2x^2\sqrt{x^2+1}-(x^2-1)\left(x{{x\over \sqrt{x^2+1}}}
+\sqrt{x^2+1}\right)\over
x^2(x^2+1)}. \\
\end{align*}
This can be simplified of course, but we have done all the calculus,
so that only algebra is left.
\end{example}

\begin{example}
Compute the derivative of $\sqrt{1+\sqrt{1+\sqrt{x}}}$. Here we have a
more complicated chain of compositions, so we use the chain rule
twice.
At the outermost ``layer'' we have the function
$g(x)=1+\sqrt{1+\sqrt{x}}$ plugged into $f(x)=\sqrt{x}$, so applying
the chain rule once gives 
$${d\over dx}\sqrt{1+\sqrt{1+\sqrt{x}}}=
{1\over 2}\left(1+\sqrt{1+\sqrt{x}}\right)^{-1/2}{d\over dx}
\left(1+\sqrt{1+\sqrt{x}}\right).$$
Now we need the derivative of $\sqrt{1+\sqrt{x}}$. Using the chain
rule again:
$${d\over dx}\sqrt{1+\sqrt{x}}={1\over
  2}\left(1+\sqrt{x}\right)^{-1/2}{1\over 2}x^{-1/2}.$$
So the original derivative is 
\begin{align*}
{d\over dx}\sqrt{1+\sqrt{1+\sqrt{x}}}&=
{1\over 2}\left(1+\sqrt{1+\sqrt{x}}\right)^{-1/2}
{1\over
  2}\left(1+\sqrt{x}\right)^{-1/2}{1\over 2}x^{-1/2}. \\
&={1\over 8 \sqrt{x}\sqrt{1+\sqrt{x}}\sqrt{1+\sqrt{1+\sqrt{x}}}}
\end{align*}
\vskip -16pt
\end{example}

Using the chain rule, the power rule, and the product rule, it is
possible to avoid using the quotient rule entirely.

\begin{example}
Compute the derivative of $f(x)={x^3\over x^2+1}$. Write 
$f(x)=x^3(x^2+1)^{-1}$, then
\begin{align*}
f'(x)&=x^3{d\over dx}(x^2+1)^{-1}+3x^2(x^2+1)^{-1} \\
&=x^3(-1)(x^2+1)^{-2}(2x)+3x^2(x^2+1)^{-1} \\
&=-2x^4(x^2+1)^{-2}+3x^2(x^2+1)^{-1} \\
&={-2x^4\over (x^2+1)^{2}}+{3x^2\over x^2+1} \\
&={-2x^4\over (x^2+1)^{2}}+{3x^2(x^2+1)\over (x^2+1)^{2}} \\
&={-2x^4+3x^4+3x^2\over (x^2+1)^{2}}={x^4+3x^2\over (x^2+1)^{2}} \\
\end{align*}
Note that we already had the derivative on the second line; all the
rest is simplification. It is easier to get to this answer by using
the quotient rule, so there's a trade off: more work for fewer
memorized formulas.
\end{example}

% Hack
% \vfill\eject

\begin{exercises}

Find the derivatives of the functions. For extra practice, and to
check your answers, do some of these in more than one way if
possible. 

\twocol

\begin{exercise} $x^4-3x^3+(1/2)x^2+7x-\pi$
\begin{answer} $4x^3-9x^2+x+7$
\end{answer}\end{exercise}

\begin{exercise} $x^3-2x^2+4\sqrt{x}$
\begin{answer} $3x^2-4x+2/\sqrt{x}$
\end{answer}\end{exercise}

\begin{exercise} $(x^2+1)^3$
\begin{answer} $6(x^2+1)^2x$
\end{answer}\end{exercise}

\begin{exercise} $x\sqrt{169-x^2}$
\begin{answer} $\sqrt{169-x^2}-x^2/\sqrt{169-x^2}$
\end{answer}\end{exercise}

\begin{exercise} $(x^2-4x+5)\sqrt{25-x^2}$
\begin{answer} $ (2x-4)\sqrt{25-x^2}-$\hfill\break$(x^2-4x+5)x/\sqrt{25-x^2}$
\end{answer}\end{exercise}

\begin{exercise} $\sqrt{r^2-x^2}$, $r$ is a constant
\begin{answer} $-x/\sqrt{r^2-x^2}$
\end{answer}\end{exercise}

\begin{exercise} $\sqrt{1+x^4}$
\begin{answer} $2x^3/\sqrt{1+x^4}$
\end{answer}\end{exercise}

\begin{exercise} ${1\over\sqrt{5-\sqrt{x}}}$.
\begin{answer} ${1\over 4\sqrt{x}(5-\sqrt{x})^{3/2}}$
\end{answer}\end{exercise}

\begin{exercise} $(1+3x)^2$
\begin{answer} $ 6+18x$
\end{answer}\end{exercise}

\begin{exercise} ${(x^2+x+1)\over(1-x)}$
\begin{answer} ${2 x + 1\over1 - x }+{x^2  + x + 1\over(1 - x)^2}$
\end{answer}\end{exercise}

\begin{exercise} ${\sqrt{25-x^2}\over x}$
\begin{answer} $ -1/\sqrt{25-x^2}-\sqrt{25-x^2}/x^2$
\end{answer}\end{exercise}

\begin{exercise} $\sqrt{{169\over x}-x}$
\begin{answer} ${1\over2}\left({-169\over x^2}-1\right)\Big/\sqrt{{169\over x}-x}$
\end{answer}\end{exercise}

\begin{exercise} $\sqrt{x^3-x^2-(1/x)}$
\begin{answer} $ {3x^2-2x+1/x^2\over 2\sqrt{x^3-x^2-(1/x)}}$
\end{answer}\end{exercise}

\begin{exercise} $100/(100-x^2)^{3/2}$
\begin{answer} $ {300 x \over(100-x^2)^{5/2}}$
\end{answer}\end{exercise}

\begin{exercise} ${\root 3 \of{x+x^3}}$
\begin{answer} $ { 1 + 3 x^2\over3(x+x^3)^{2/3}}$
\end{answer}\end{exercise}

\begin{exercise} $\sqrt{(x^2+1)^2+\sqrt{1+(x^2+1)^2}}$
\begin{answer} $ \left(4x(x^2+1)+{4x^3+4x\over2\sqrt{1+(x^2+1)^2}}\right)\Big/$
\hfill\break$2\sqrt{(x^2+1)^2+\sqrt{1+(x^2+1)^2}}$
\end{answer}\end{exercise}

\begin{exercise} $(x+8)^5$
\begin{answer} $5(x+8)^4$
\end{answer}\end{exercise}

\begin{exercise} $(4-x)^3$
\begin{answer} $-3(4-x)^2$
\end{answer}\end{exercise}

\begin{exercise} $(x^2+5)^3$
\begin{answer} $6x(x^2+5)^2$
\end{answer}\end{exercise}

\begin{exercise} $(6-2x^2)^3$
\begin{answer} $-12x(6-2x^2)^2$
\end{answer}\end{exercise}

\begin{exercise} $(1-4x^3)^{-2}$
\begin{answer} $24x^2(1-4x^3)^{-3}$
\end{answer}\end{exercise}

\begin{exercise} $5(x+1-1/x)$
\begin{answer} $5+5/x^2$
\end{answer}\end{exercise}

\begin{exercise} $4(2x^2-x+3)^{-2}$
\begin{answer} $-8(4x-1)(2x^2-x+3)^{-3}$
\end{answer}\end{exercise}

\begin{exercise} ${1\over 1+1/x}$
\begin{answer} $1/(x+1)^2$
\end{answer}\end{exercise}

\begin{exercise} ${-3\over 4x^2-2x+1}$
\begin{answer} $3(8x-2)/(4x^2-2x+1)^2$
\end{answer}\end{exercise}

\begin{exercise} $(x^2+1)(5-2x)/2$
\begin{answer} $-3x^2+5x-1$
\end{answer}\end{exercise}

\begin{exercise} $(3x^2+1)(2x-4)^3$
%\begin{answer} $120x^4-576x^3+888x^2-480x+96$
\begin{answer} $6x(2x-4)^3+6(3x^2+1)(2x-4)^2$
\end{answer}\end{exercise}

\begin{exercise} ${x+1\over x-1}$
\begin{answer} $-2/(x-1)^2$
\end{answer}\end{exercise}

\begin{exercise} ${x^2-1\over x^2+1}$
\begin{answer} $4x/(x^2+1)^2$
\end{answer}\end{exercise}

\begin{exercise} ${(x-1)(x-2)\over x-3}$
\begin{answer} $(x^2-6x+7)/(x-3)^2$
\end{answer}\end{exercise}

\begin{exercise} ${2x^{-1}-x^{-2}\over 3x^{-1}-4x^{-2}}$
\begin{answer} $-5/(3x-4)^2$
\end{answer}\end{exercise}

\begin{exercise} $3(x^2+1)(2x^2-1)(2x+3)$
\begin{answer} $60x^4+72x^3+18x^2+18x-6$
\end{answer}\end{exercise}

\begin{exercise} ${1\over (2x+1)(x-3)}$
\begin{answer} $(5-4x)/((2x+1)^2(x-3)^2)$
\end{answer}\end{exercise}

\begin{exercise} $((2x+1)^{-1}+3)^{-1}$
\begin{answer} $1/(2(2+3x)^2)$
\end{answer}\end{exercise}

\begin{exercise} $(2x+1)^3(x^2+1)^2$
\begin{answer} $56x^6+72x^5+110x^4+100x^3+60x^2+28x+6$
\end{answer}\end{exercise}

\endtwocol
\bsk

\begin{exercise}  Find an equation for the tangent line to 
$f(x) = (x-2)^{1/3}/(x^3 + 4x - 1)^2$ at $x=1$.
\begin{answer} $y=23x/96-29/96$
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to $y=9x^{-2}$ at $(3,1)$.
\begin{answer} $y=3-2x/3$
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to $(x^2-4x+5)\sqrt{25-x^2}$ 
at $(3,8)$.
\begin{answer} $y=13x/2-23/2$
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to ${(x^2+x+1)\over(1-x)}$ 
at $(2,-7)$.
\begin{answer} $y=2x-11$
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to 
$\sqrt{(x^2+1)^2+\sqrt{1+(x^2+1)^2}}$
at $(1,\sqrt{4+\sqrt{5}})$.
\begin{answer} $y=
{20+2\sqrt5\over5\sqrt{4+\sqrt5}}\,x+{3\sqrt5\over5\sqrt{4+\sqrt5}}$
\end{answer}\end{exercise}

\end{exercises}















\begin{exercise} $\ddx\frac{\sqrt{625-x^2}}{x^{20}}$
\begin{answer} $\frac{-1}{x^{19}\sqrt{625-x^2}}-\frac{20\sqrt{625-x^2}}{x^{21}}$
\end{answer}\end{exercise}



\begin{exercise} $\ddx \sqrt{x}\sqrt{625-x^2}$
\begin{answer} $\frac{\sqrt{625-x^2}}{2\sqrt{x}}-\frac{x\sqrt{x}}{\sqrt{625-x^2}}$
\end{answer}\end{exercise}












\section{Implicit Differentiation}



As we have seen, there is a close relationship between the derivatives
of $e^x$ and $\ln x$ because these functions are inverses. Rather
than relying on pictures for our understanding, we would like to be
able to exploit this relationship computationally.  In fact this
technique can help us find derivatives in many situations, not just
when we seek the derivative of an inverse function.

We will begin by illustrating the technique to find what we already
know, the derivative of $\ln x$. Let's write $y=\ln x$ and then $
x=e^{\ln x}=e^y$, that is, $x=e^y$. We say that this equation
defines the function $y=\ln x$ implicitly\index{implicit
  function}\index{function!implicit} because while it is not an
explicit expression $y=\ldots$, it is true that if $x=e^y$ then
$y$ is in fact the natural logarithm function. Now, for the time
being, pretend that all we know of $y$ is that $x=e^y$; what can
we say about derivatives? We can take the derivative of both sides of
the equation:
$${d\over dx}x={d\over dx}e^y.$$
Then using the chain rule on the right hand side:
$$1 = \left({d\over dx}y\right) e^y = y'e^y.$$
Then we can solve for $y'$:
$$y'={1\over e^y} = {1\over x}.$$
There is one little difficulty here. To use the chain rule to compute 
$d/dx(e^y)=y'e^y$ we need to know that the function $y$ {\it has\/} a
derivative. All we have shown is that {\it if\/} it has a derivative
then that derivative must be $1/x$. When using this method we will
always have to assume that the desired derivative exists, but
fortunately this is a safe assumption for most such problems. 

The example $y=\ln x$ involved an inverse function defined implicitly,
but other functions can be defined implicitly, and sometimes a single
equation can be used to implicitly define more than one
function. 

Here's a familiar example. The equation $r^2=x^2+y^2$
describes a circle of radius $r$. The circle is not a function
$y=f(x)$ because for some values of $x$ there are two corresponding
values of $y$. If we want to work with a function, we can break the
circle into two pieces, the upper and lower semicircles, each of which
is a function. Let's call these $y=U(x)$ and $y=L(x)$; in fact this is
a fairly simple example, and it's possible to give explicit
expressions for these: $U(x)=\sqrt{r^2-x^2\ }$ and
$L(x)=-\sqrt{r^2-x^2\ }$.  But it's somewhat easier, and quite useful,
to view both functions as given implicitly by $r^2=x^2+y^2$: both
$r^2=x^2+U(x)^2$ and $r^2=x^2+L(x)^2$ are true, and we can think of 
$r^2=x^2+y^2$ as defining both $U(x)$ and $L(x)$.

Now we can take the derivative of both sides as before, remembering
that $y$ is not simply a variable but a function---in this case, $y$
is either $U(x)$ or $L(x)$ but we're not yet specifying which one.
When we take the derivative we just have to remember to apply the
chain rule where $y$ appears.
\begin{align*}
{d\over dx}r^2&={d\over dx}(x^2+y^2) \\
0&=2x+2yy' \\
y'&={-2x\over 2y}=-{x\over y} \\
\end{align*}
Now we have an expression for $y'$, but it contains $y$ as well as
$x$. This means that if we want to compute $y'$ for some particular
value of $x$ we'll have to know or compute $y$ at that value of $x$ as
well. It is at this point that we will need to know whether $y$ is
$U(x)$ or $L(x)$. Occasionally it will turn out that we can avoid
explicit use of $U(x)$ or $L(x)$ by the nature of the problem

\begin{example}
Find the slope of the circle $4=x^2+y^2$ at the point
$(1,-\sqrt{3})$. Since we know both the $x$ and $y$ coordinates of the
point of interest, we do not need to explicitly recognize that this
point is on $L(x)$, and we do not need to use $L(x)$ to compute
$y$---but we could. Using the calculation of $y'$ from above, 
$$y'=-{x\over y}=-{1\over -\sqrt{3}}={1\over \sqrt{3}}.$$
It is instructive to compare this approach to others.

We might have recognized at the start that $(1,-\sqrt{3})$ is on the
function $y=L(x)=-\sqrt{4-x^2}$. We could then take the derivative of
$L(x)$, using the power rule and the chain rule, to get
$$L'(x)=-{1\over 2}(4-x^2)^{-1/2}(-2x)={x\over\sqrt{4-x^2}}.$$
Then we could compute $L'(1)=1/\sqrt{3}$ by substituting $x=1$.

Alternately, we could realize that the point is on $L(x)$, but use the
fact that $y'=-x/y$. Since the point is on $L(x)$ we can replace $y$
by $L(x)$ to get
$$y'=-{x\over L(x)}=-{x\over \sqrt{4-x^2}},$$
without computing the derivative of $L(x)$ explicitly. Then we
substitute $x=1$ and get the same answer as before.
\end{example}

In the case of the circle it is possible to find the functions $U(x)$
and $L(x)$ explicitly, but there are potential advantages to using
implicit differentiation anyway. In some cases it is more difficult or
impossible to find an explicit formula for $y$ and implicit
differentiation is the only way to find the derivative.

\begin{example}
Find the derivative of any function defined implicitly by 
$yx^2+e^y=x$. We treat $y$ as an unspecified function and use the
chain rule:
\begin{align*}
{d\over dx}(yx^2+e^y)&={d\over dx}x \\
(y\cdot 2x+y'\cdot x^2)+y'e^y &= 1 \\
y'x^2+y'e^y&= 1-2xy \\
y'(x^2+e^y)&= 1-2xy \\
y'&={1-2xy\over x^2+e^y} \\
\end{align*}
\vskip-18pt\end{example}

You might think that the step in which we solve for $y'$ could
sometimes be difficult---after all, we're using implicit
differentiation here because we can't solve the equation
$yx^2+e^y=x$ for $y$, so maybe after taking the derivative we get
something that is hard to solve for $y'$. In fact, {\it this never
  happens.} All occurrences $y'$ come from applying the chain rule,
and whenever the chain rule is used it deposits a single $y'$
multiplied by some other expression. So it will always be possible to
group the terms containing $y'$ together and factor out the $y'$, just
as in the previous example. If you ever get anything more difficult
you have made a mistake and should fix it before trying to continue.

It is sometimes the case that a situation leads naturally to an
equation that defines a function implicitly. 

\begin{example} Consider all the points $(x,y)$ that have the property that 
the distance from $(x,y)$ to $(x_1,y_1)$ plus the distance 
from $(x,y)$ to $(x_2,y_2)$ is $2a$ ($a$ is some constant). These
points form an ellipse, which like a circle is not a function but can
viewed as two functions pasted together. Because we know how to write
down the distance between two points, we can write down an implicit
equation for the ellipse:
$$\sqrt{(x-x_1)^2+(y-y_1)^2}+\sqrt{(x-x_2)^2+(y-y_2)^2}=2a.$$
Then we can use implicit differentiation to find the slope of the
ellipse at any point, though the computation is rather messy.
\label{example:ellipse}
\end{example}

\begin{example} We have already justified the power\index{power rule} rule by
using the exponential function, but we could also do it for rational
exponents by using implicit differentiation.  Suppose that
$y=x^{m/n}$, where $m$ and $n$ are positive integers. We can write
this implicitly as $y^n=x^m$, then because we justified the power rule
for integers, we can take the derivative of each side:
\begin{align*}
ny^{n-1}y' &= mx^{m-1} \\
y'&= {m\over n}{x^{m-1}\over y^{n-1}} \\
y'&= {m\over n}{x^{m-1}\over (x^{m/n})^{n-1}} \\
y'&= {m\over n}x^{m-1-(m/n)(n-1)} \\
y'&= {m\over n}x^{m-1-m+(m/n)} \\
y'&= {m\over n}x^{(m/n)-1} \\
\end{align*}
\end{example}

\begin{exercises}

In exercises 1--8, find a formula for the derivative $y'$ at the point
$(x,y)$:

\begin{exercise} $y^2=1+x^2$
\begin{answer} $x/y$
\end{answer}\end{exercise}

\begin{exercise} $x^2+xy+y^2=7$
\begin{answer} $-(2x+y)/(x+2y)$
\end{answer}\end{exercise}

\begin{exercise} $x^3+xy^2=y^3+yx^2$
\begin{answer} $(2xy-3x^2-y^2)/(2xy-3y^2-x^2)$
\end{answer}\end{exercise}

\begin{exercise}  $4\cos x \sin y = 1$
\begin{answer} $\sin(x)\sin(y)/(\cos(x)\cos(y))$
\end{answer}\end{exercise}

\begin{exercise} $\sqrt{x} + \sqrt{y} = 9$
\begin{answer} $-\sqrt{y}/\sqrt{x}$
\end{answer}\end{exercise}

\begin{exercise} $\tan(x/y) = x+ y$
 \begin{answer} $(y\sec^2(x/y)-y^2)/(x\sec^2(x/y)+y^2)$
\end{answer}\end{exercise}

\begin{exercise} $\sin (x+y ) =xy$
 \begin{answer} $(y-\cos(x+y))/(\cos(x+y)-x)$
\end{answer}\end{exercise}

\begin{exercise} ${1\over x} + {1\over y} = 7$
\begin{answer} $-y^2/x^2$
\end{answer}\end{exercise}

\begin{exercise}
A hyperbola passing through $(8,6)$ consists of all points whose distance
from the origin is a constant more than its distance from the point (5,2).
Find the slope of the tangent line to the hyperbola at $(8,6)$.
\begin{answer} $1$
\end{answer}\end{exercise}

\begin{exercise}
Compute $y'$ for the ellipse of example~\xrefn{example:ellipse}.
%% \begin{answer} {\fivepoint 
%% \hbox{$\bigg({x_1-x\over\sqrt{(x-x_1)^2+(y-y_1)^2}}+
%% {x_2-x\over\sqrt{(x-x_2)^2+(y-y_2)^2}}\bigg)\bigg/$}\hfill\break
%% \hbox{$\bigg(
%% {y-y_1\over\sqrt{(x-x_1)^2+(y-y_1)^2}}+
%% {y-y_2\over\sqrt{(x-x_2)^2+(y-y_2)^2}}\bigg)$}}
%% \end{answer}
\end{exercise}

\begin{exercise} The graph of the equation $x^2 - xy + y^2 = 9$ is an ellipse.
Find the lines tangent to this curve at the two
 points where it intersects the $x$-axis. Show that these lines are
 parallel.
\begin{answer} $y=2x\pm6$
\end{answer}\end{exercise}

\begin{exercise} Repeat the previous problem for the points at which the
 ellipse intersects the $y$-axis.
\begin{answer} $y=x/2\pm3$
\end{answer}\end{exercise}

\begin{exercise} Find the points on the ellipse from the previous two problems
 where the slope is horizontal and where it is vertical.
\begin{answer} $(\sqrt3,2\sqrt3)$, $(-\sqrt3,-2\sqrt3)$, $(2\sqrt3,\sqrt3)$,
$(-2\sqrt3,-\sqrt3)$ 
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to 
$x^4 = y^2 + x^2$ at $(2, \sqrt{12})$. 
(This curve is the {\dfont kampyle of Eudoxus}.)
\begin{answer} $y=7x/\sqrt3-8/\sqrt3$
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to $x^{2/3} +
y^{2/3} = a^{2/3}$ at a point $(x_1 ,y_1)$ on the curve, 
with $x_1 \neq 0$ and $y_1 \neq 0$. (This curve is an {\dfont astroid}.)
\begin{answer} $y=(-y_1^{1/3}x+y_1^{1/3}x_1+x_1^{1/3}y_1)/x_1^{1/3}$
\end{answer}\end{exercise}

\begin{exercise} Find an equation for the tangent line to $(x^2 +y^2 )^2 =x^2
-y^2$ at a point $(x_1 , y_1)$ on the curve, with $x_1 \neq 0, -1, 1$.
(This curve is a {\dfont lemniscate}.)
\begin{answer} $(y-y_1)/(x-x_1)=(2x_1^3+2x_1y_1^2-x_1)/(2y_1^3+2y_1x_1^2+y_1)$
\end{answer}\end{exercise}

\begin{remark}{Definition}
Two curves are {\dfont orthogonal\/} if at each point of intersection,
the angle between their tangent lines is $\pi/2$. Two
families of curves, $\cal{A}$ and $\cal{B}$, are
{\dfont orthogonal trajectories} of each other if given any curve $C$
in $\cal{A}$ and any curve $D$ in $\cal{B}$ the curves $C$
and $D$ are orthogonal.
For example, the family of horizontal lines in the plane is
orthogonal to the family of vertical lines in the plane.
\end{remark}

 \begin{exercise} Show that $x^2 -y^2 =5$ is orthogonal to $4x^2 +9y^2
 =72$. (Hint: You need to find the intersection points of the two
 curves and then show that the product of the derivatives at each
 intersection point is $-1$.)
\end{exercise}

\begin{exercise} Show that $x^2 +y^2 = r^2$ is orthogonal to
$y=mx$. Conclude that the family of circles centered at the origin is
an orthogonal trajectory of the family of lines that pass through the
origin.

Note that there is a technical issue when $m=0$. The circles fail to
be differentiable when they cross the $x$-axis. However, the circles
are orthogonal to the $x$-axis. Explain why. Likewise, the vertical
line through the origin requires a separate argument.
\end{exercise}

\begin{exercise} For $k\not= 0$ and $c \neq 0$ show that $y^2 -x^2 =k$ is orthogonal to
$yx =c$. In the case where $k$ and $c$ are both zero, the curves
  intersect at the origin. Are the curves $y^2 -x^2 =0$ and $yx=0$
  orthogonal to each other?
\end{exercise}

\begin{exercise} Suppose that $m\neq 0$. Show that the family of curves
$\{y=mx+b \mid b\in \R \}$ is orthogonal to the
family of curves $\{y=-(x/m)+c \mid c \in \R\}$.
\end{exercise}

\end{exercises}





















\section{Logarithmtic Differentiation}











%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\section{The Derivative of Trigonometric Functions}



%\section{Rates of Change}


%\section{Applications}

%\subsection{Related Rates}
