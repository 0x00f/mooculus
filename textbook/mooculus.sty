\NeedsTeXFormat{LaTeX2e}% LaTeX 2.09 can't be used (nor non-LaTeX)
[1994/12/01]% LaTeX date must be December 1994 or later
\ProvidesPackage{mooculus}[2012/01/30 v0.75]
\ProcessOptions\relax


%% need to install mdframed!!! NEED TeXLive 2012! (Ubuntu comes with 2009)
%% the tcolorbox package is interesting...



%Colors
\usepackage[usenames,dvipsnames]{xcolor}
\colorlet{background}{Apricot!7} % Color of the page
\colorlet{textColor}{Sepia!60!black} % Color of the text
%\colorlet{background}{white} % Color of the page
%\colorlet{textColor}{black} % Color of the text
\colorlet{penColor}{green!50!black} % Color of a curve in a plot
\colorlet{fill1}{cyan!20} % Color of fill in a plot
\colorlet{fill1}{green!50!black!20} % Color of fill in a plot
\colorlet{fill2}{blue!10} % Color of fill in a plot
\colorlet{gridColor}{gray!30} % Color of grid in a plot
\colorlet{definitionBackground}{Sepia} % Color of the background of a definition
\colorlet{theoremBackground}{BrickRed} % Color of the background of a theorem
\colorlet{mainTheoremBorder}{Sepia} % Color of the border of a main theorem


\pagecolor{background}
\color{textColor} 


%\RequirePackage[tikz]{mdframed}
\RequirePackage{environ}
%\RequirePackage{xkeyval}
\RequirePackage{tikz}
\RequirePackage{amssymb}
\RequirePackage{amsmath}
\RequirePackage{amsthm}
\RequirePackage{microtype}
\RequirePackage{enumerate}

\usepackage[notextcomp]{kpfonts}
\RequirePackage[T1]{fontenc}

\usetikzlibrary{shadows}
\usetikzlibrary{shapes}
\usetikzlibrary{decorations}



\renewcommand{\epsilon}{\varepsilon}

\geometry{landscape,
  left=1in,
  top=1in,
  textheight=6.5in,
  textwidth=5in,
  marginparsep=0.5in,
  marginparwidth=2.5in}

 
\NewEnviron{mainTheorem}[1][Theorem]{%
  \begin{center}
    \begin{tikzpicture}
      \node[rectangle,rounded corners,inner sep=5pt,minimum width=\textwidth,
        text=textColor, text opacity=1,draw=mainTheoremBorder, ultra thick, draw opacity=1,
        fill=theoremBackground, fill opacity=.1] 
      (box){%
        \begin{minipage}{.95\textwidth}
          \textbf{#1}\qquad\color{textColor}\BODY
      \end{minipage}};
    \end{tikzpicture}
  \end{center}
}

%% \newmdtheoremenv[outerlinewidth=2pt,leftmargin=40pt,%  %%%% needs mdtheorem
%%   rightmargin=40pt,backgroundcolor=theoremBackground,%
%%   outerlinecolor=textColor,innertopmargin=\topskip,%
%%   splittopskip=\topskip,skipbelow=\baselineskip,%
%%   skipabove=\baselineskip,ntheorem]{theorem}%
%%                 {Theorem}[section]

\NewEnviron{theorem}[1][Theorem]{%
  \begin{center}
    \begin{tikzpicture}
      \node[rectangle,rounded corners,inner sep=5pt,minimum width=\textwidth,
        text=textColor, text opacity=1,
        %draw=gray, ultra thick, draw opacity=1,
        fill=theoremBackground, fill opacity=.1] 
      (box){%
        \begin{minipage}{.95\textwidth}
          \textbf{#1}\qquad\color{textColor}\BODY
      \end{minipage}};
    \end{tikzpicture}
  \end{center}
}

\NewEnviron{definition}{%
  \begin{center}
    \begin{tikzpicture}
      \node[rectangle, rounded corners,inner sep=5pt,minimum width=\textwidth,
        text=textColor, text opacity=1,
        fill=definitionBackground, fill opacity=.1] 
      (box){%
        \begin{minipage}{.95\textwidth}
          \textbf{Definition}\qquad\color{textColor}\BODY
      \end{minipage}};
    \end{tikzpicture}
  \end{center}
}

%% \NewEnviron{solution}{%
%%   \begin{center}
%%     \begin{tikzpicture}
%%       \node[rectangle, rounded corners,inner sep=5pt,minimum width=\textwidth,
%%         text=textColor, text opacity=1,
%%         fill=definitionBackground, fill opacity=.1] 
%%       (box){%
%%         \begin{minipage}{.95\textwidth}
%%           \textit{\textbf{Solution}}\qquad\color{textColor}\BODY
%%       \end{minipage}};
%%     \end{tikzpicture}
%%   \end{center}
%% }


\NewEnviron{warning}{%
  \begin{center}
    \begin{tikzpicture}
      \node[rectangle, rounded corners, inner sep=5pt,minimum width=\textwidth,
        text=textColor, text opacity=1,
        fill=red, fill opacity=.1] 
      (box){%
        \begin{minipage}{.95\textwidth}
          \textbf{WARNING}\qquad\BODY
      \end{minipage}};
    \end{tikzpicture}
  \end{center}
}


\NewEnviron{ques}{%
  \begin{center}
    \begin{tikzpicture}
      \node[rectangle, rounded corners, inner sep=5pt,minimum width=\textwidth,
        text=textColor, text opacity=1,
        fill=green!50!blue, fill opacity=.15] 
      (box){%
        \begin{minipage}{.95\textwidth}
          \textbf{Question}\qquad\BODY
      \end{minipage}};
    \end{tikzpicture}
  \end{center}
}

\RequirePackage{framed}
\newenvironment{example}{\begin{leftbar}\noindent\textbf{Example}\qquad}{\end{leftbar}}
\newenvironment{solution}{\noindent\textit{\textbf{Solution}}\qquad} %% SHOULD BE REPLACED WITH MDFRAMED!





\usepackage{multicol} % Use letters for lists
\renewcommand{\theenumi}{$(\mathrm{\alph{enumi}})$}
\renewcommand{\labelenumi}{\theenumi}


\newcounter{exercise}
\NewEnviron{exercises}{%
  \subsection*{Exercises for Section \arabic{chapter}.\arabic{section}}
\vspace{-14pt}

\rule{\textwidth}{1pt}
  \setcounter{exercise}{0}
  \BODY
  \dumpanswer[\noexpand\subsection*{Answers for \arabic{chapter}.\arabic{section}}]
\newpage
}%
{}
\newenvironment{exercise}{
\begin{enumerate}[(1)]
  \setcounter{enumi}{\value{exercise}}
  \item \addtocounter{exercise}{1}
}
{\end{enumerate}}



%\NewEnviron{example}{%
%  \begin{center}
%    \begin{tikzpicture}
%      \node[rectangle, rounded corners, inner sep=5pt,minimum width=\textwidth,
%        text=black, text opacity=1,
%        fill=black, fill opacity=.1] 
%      (box){%
%        \begin{minipage}{.95\textwidth}
%          \textbf{Example}\qquad\BODY
%      \end{minipage}};
%    \end{tikzpicture}
%  \end{center}
%}

\newcommand{\drawfoot}{% %% changed black -> textColor, white -> background
  \begin{scope}[xshift=0.06in,color=textColor]
    \draw[fill=textColor!70!background] (0,0) arc (0:180:0.12in) -- (0,0) -- cycle;
    \draw (-0.1in,0) arc (0:30:0.12in);
  \end{scope}
}

\newcommand{\drawhorn}{%
      \draw[color=brown!80!black,fill=brown] (0,0)
      arc (30:60:0.45in)
      arc (30:0:0.4in);
}

\newcommand{\draweye}{% %% changed black -> textColor, white -> background
      \draw[fill=background] (0,0) circle (0.09in);
      \draw[fill=textColor] (0.02in,-0.02in) circle (0.02in);
}

\newcommand{\headpath}{%
(0,0in)
arc (90:175:0.35in) % top ear
arc (250:300:0.25in) % bottom ear
arc (170:270:0.30in) % chin
arc (-90:10:0.30in) % chin
arc (-120:-70:0.25in) % bottom ear
arc (5:90:0.35in) % top ear
-- cycle
}



\renewcommand{\maketitlepage}[0]{%
  \cleardoublepage%
  {%
  \sffamily%
  \begin{fullwidth}%
    %\vfill

    \vspace*{1.75in}

    \begin{tikzpicture}[line width=1pt,scale=0.5, every node/.style={transform shape}]]  %%%%%%%% begin cow
    % draw body
    \begin{scope}
      %\draw[line width=2pt] (0,0) circle (0.5in);
      \draw[] (0,0) circle (0.5in);
      
      \clip (0,0) circle (0.5in);
      \begin{scope}[color=textColor!85!background] %% changed black -> textColor, white -> background
        
    \fill[xshift=0.2in,yshift=0.1in] plot [smooth cycle, tension=2] coordinates { (0,0) (0.6,0.6) (-0.6,0.6) };

    \fill[xshift=0.4in,yshift=-0.4in] plot [smooth cycle, tension=2] coordinates { (0,0) (0.6,0.6) (-0.6,0.6) };

    \fill[xshift=-0.4in,yshift=-0.6in] plot [smooth cycle, tension=2] coordinates { (0,0) (0.6,0.6) (-0.6,0.6) };

    \fill[xshift=-0.2in,yshift=0.1in] plot [smooth cycle, tension=2] coordinates { (0,0) (-0.2,-0.6) (0.6,-0.6) };

    \fill[xshift=-0.2in,yshift=0.5in] plot [smooth cycle, tension=2] coordinates { (0.35,0.35) (-0.9,-0.8) (0.2,-0.2) };

      \end{scope}

    \end{scope}

    \begin{scope}
      \clip (0,0) circle (0.5in);

      \fill[color=black,join=round] (1.75,-1.75) -- (1.75,0.5) --
        (3.75, 0.5) -- (3.75,-1.75);
    \end{scope}

    % draw right foot
    \begin{scope}[yshift=-0.53in]
      \begin{scope}[xshift=0.3in]
        \drawfoot
      \end{scope}

      % draw left foot
      \begin{scope}[xshift=-0.3in,xscale=-1]
        \drawfoot
      \end{scope}
    \end{scope}

    % draw head
    \begin{scope}[yshift=0.6in,xshift=-.15in]
    \draw[fill=background] \headpath; %% changed white -> background

    \clip \headpath;
    \fill[color=textColor!85!background,xshift=0.65in,yshift=0.2in] plot [smooth cycle, tension=2] coordinates { (0,0) (-1,-1) (-0.5,0.5) }; %% changed black -> textColor, white -> background

    % draw nose
    \begin{scope}[xshift=.15in,xscale=1.5,yshift=-0.6in,color=pink!50!black]
      \draw[fill=pink] (0in,0) circle (0.09in);
      \draw (0.1,0.1) -- (0.1,0);
      \draw (-0.1,0.1) -- (-0.1,0);
    \end{scope}

    \draw[stroke=black,fill=none] \headpath;
    \end{scope}

    % draw horn
    \begin{scope}[yshift=0.55in]
      \begin{scope}[xshift=-.15in]
        \drawhorn
      \end{scope}
      \begin{scope}[xshift=.15in,xscale=-1]
        \drawhorn
      \end{scope}
    \end{scope}

    % draw eyes
    \begin{scope}[yshift=0.4in]
      \begin{scope}[xshift=-.11in]
        \draweye
      \end{scope}
      \begin{scope}[xshift=.11in,xscale=-1]
        \draweye
      \end{scope}
    \end{scope}

    % draw title MOOCulus
    \node[anchor=west] at (0.5in,0.2) {\scalebox{3.2}{\sffamily\Huge\textbf{M}}};
    \node[anchor=west] at (1.35in,0.2) {\scalebox{3.2}{\sffamily\Huge\textbf{O}}};
    \node[anchor=west] at (2.16in,0.2) {\scalebox{3.2}{\sffamily\Huge\textbf{O}}};
    \node[anchor=west] at (2.97in,0.2) {\scalebox{3.2}{\sffamily\Huge\textbf{C}}};
    \node[anchor=west] at (3.7in,-0.08) {\scalebox{3.2}{\sffamily\scshape\Huge ulus}};

    % draw subtitle
    \node[anchor=north west] at (0.6in,-0.30in) {\sffamily\scalebox{2.1}{\footnotesize massive open online calculus}};

    
  \end{tikzpicture}%%%% end cow
  \fontsize{56}{60}\selectfont\par\noindent\textcolor{textColor}{\bfseries\allcaps{\thanklesstitle}}%
  \vfill%
  \fontsize{18}{20}\selectfont\par\noindent\textcolor{textColor}{\allcaps{\thanklessauthor}}%
  %\vspace{11.5pc}%
  \fontsize{14}{16}\selectfont\par\noindent\allcaps{\thanklesspublisher}%
  \end{fullwidth}%
  }
  \thispagestyle{empty}%
  \clearpage%
}




\RequirePackage{titlesec}
\titleformat{\chapter}%
  [display]% shape
  {\relax\ifthenelse{\NOT\boolean{@tufte@symmetric}}{\begin{fullwidth}}{}}% format applied to label+text
  {\huge\scshape\sffamily\textcolor{textColor}\thechapter}% label
  {1em}% horizontal separation between label and title body
  {\huge\scshape\sffamily\textcolor{textColor}}% before the title body
  [\ifthenelse{\NOT\boolean{@tufte@symmetric}}{\end{fullwidth}}{}]% after the title body

\titleformat{\section}%
  [hang]% shape
  {\normalfont\Large\sffamily}% format applied to label+text
  {\thesection}% label
  {1em}% horizontal separation between label and title body
  {}% before the title body
  []% after the title body

\titleformat{\subsection}%
  [hang]% shape
  {\normalfont\large\sffamily}% format applied to label+text
  {\thesubsection}% label
  {1em}% horizontal separation between label and title body
  {}% before the title body
  []% after the title body

\titleformat{\paragraph}%
  [runin]% shape
  {\normalfont\sffamily}% format applied to label+text
  {\theparagraph}% label
  {1em}% horizontal separation between label and title body
  {}% before the title body
  []% after the title body



\ifthenelse{\boolean{@tufte@toc}}{%
  \titlecontents{part}% FIXME
    [0em] % distance from left margin
    {\vspace{1.5\baselineskip}\begin{fullwidth}\LARGE\sffamily} % above (global formatting of entry)
    {\contentslabel{2em}} % before w/label (label = ``II'')
    {} % before w/o label
    {\sffamily\qquad\thecontentspage} % filler + page (leaders and page num)
    [\end{fullwidth}] % after
  \titlecontents{chapter}%
    [0em] % distance from left margin
    {\vspace{1.5\baselineskip}\begin{fullwidth}\LARGE\sffamily} % above (global formatting of entry)
    {\hspace*{0em}\contentslabel{2em}} % before w/label (label = ``2'')
    {\hspace*{0em}} % before w/o label
    {\sffamily\hfill\qquad\thecontentspage} % filler + page (leaders and page num)
    [\end{fullwidth}] % after
  \titlecontents{section}% FIXME
    [0em] % distance from left margin
    {\vspace{0\baselineskip}\begin{fullwidth}\Large\sffamily} % above (global formatting of entry)
    {\hspace*{2em}\contentslabel{2em}} % before w/label (label = ``2.6'')
    {\hspace*{2em}} % before w/o label
    {\sffamily\qquad\thecontentspage} % filler + page (leaders and page num)
    [\end{fullwidth}] % after
  \titlecontents{subsection}% FIXME
    [0em] % distance from left margin
    {\vspace{0\baselineskip}\begin{fullwidth}\large\sffamily} % above (global formatting of entry)
    {\hspace*{4em}\contentslabel{4em}} % before w/label (label = ``2.6.1'')
    {\hspace*{4em}} % before w/o label
    {\sffamily\qquad\thecontentspage} % filler + page (leaders and page num)
    [\end{fullwidth}] % after
  \titlecontents{paragraph}% FIXME
    [0em] % distance from left margin
    {\vspace{0\baselineskip}\begin{fullwidth}\normalsize\sffamily} % above (global formatting of entry)
    {\hspace*{6em}\contentslabel{2em}} % before w/label (label = ``2.6.0.0.1'')
    {\hspace*{6em}} % before w/o label
    {\sffamily\qquad\thecontentspage} % filler + page (leaders and page num)
    [\end{fullwidth}] % after
}{}



\endinput
